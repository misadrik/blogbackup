<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title>多线程，多进程下微博图片</title>
      <link href="/2018/04/25/2018-04-25-downloadpics/"/>
      <url>/2018/04/25/2018-04-25-downloadpics/</url>
      <content type="html"><![CDATA[<h1 id="图片多线程多进程下载"><a href="#图片多线程多进程下载" class="headerlink" title="图片多线程多进程下载"></a>图片多线程多进程下载</h1><h1 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h1><p>爬了微博后图片一直是用链接保存的，前阵子喜欢上了优子酱，喜欢着装风格，疯狂找图片，于是爬了她的粉丝微博，下了所有的图片。由于这个实现起来没有顺序，相对简单，下一步就要考虑用多线程和多进程对微博爬虫进行改造了，不过这个需要时间，等技术更加纯熟再弄可能会更好。<br><a id="more"></a></p><h1 id="主要内容"><a href="#主要内容" class="headerlink" title="主要内容"></a>主要内容</h1><h2 id="下载函数urlretrieve"><a href="#下载函数urlretrieve" class="headerlink" title="下载函数urlretrieve"></a>下载函数urlretrieve</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> urllib.request</span><br><span class="line">urlretrieve(url, filename=<span class="keyword">None</span>, reporthook=<span class="keyword">None</span>, data=<span class="keyword">None</span>)</span><br></pre></td></tr></table></figure><ul><li>参数 <strong>finename</strong> 指定了保存本地路径（如果参数未指定，urllib会生成一个临时文件保存数据。）</li><li>参数<strong>reporthook</strong>是一个回调函数，当连接上服务器、以及相应的数据块传输完毕时会触发该回调，我们可以利用这个回调函数来显示当前的下载进度。</li><li>参数<strong>data</strong>指 post 到服务器的数据，该方法返回一个包含两个元素的(filename, headers)元组，filename 表示保存到本地的路径，header 表示服务器的响应头</li></ul><h2 id="多线程threading"><a href="#多线程threading" class="headerlink" title="多线程threading"></a>多线程threading</h2><h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><p>多线程是并行的一种。计算机只有一个CPU核心，同时只能处理一个任务。这样的情况下，多线程可以理解为开辟多条道路，但道路的出口只有一个。哪条路上的车抢到了通行权这条路上的汽车就会优先通过，直到下条路上的车抢到通行权，此时其他路上的汽车都会进入等待状态。使用多线程，可以大大的增加程序的性能和效率。</p><p>###多线程的使用</p><p>在python3 中一般使用 threading 库</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line">t = Thread(target=function_name, args=(function_parameter1, function_parameterN)) <span class="comment"># 启动刚刚创建的线程 </span></span><br><span class="line">t.start()</span><br></pre></td></tr></table></figure><ul><li>参数<strong>function_name</strong>用于指定执行多线程的<strong>函数名字</strong>（只要名字）</li><li>参数<strong>args</strong>是前述函数的参数</li></ul><p>此函数也可通过类的继承使用</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">my_Thread</span> <span class="params">(threading.Thread)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, threadID, name, delay)</span>:</span></span><br><span class="line">        threading.Thread.__init__(self)</span><br><span class="line">        self.threadID = threadID</span><br><span class="line">        self.name = name</span><br><span class="line">        self.delay = delay</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">print</span> (<span class="string">"开始线程："</span> + self.name)</span><br><span class="line">        print_datetime(self.name, self.delay, <span class="number">5</span>)</span><br><span class="line">        <span class="keyword">print</span> (<span class="string">"退出线程："</span> + self.name)</span><br><span class="line">        </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">print_datetime</span><span class="params">(threadName, delay, counter)</span>:</span></span><br><span class="line">    <span class="keyword">while</span> counter:</span><br><span class="line">        time.sleep(delay)</span><br><span class="line">        <span class="keyword">print</span> (<span class="string">"%s: %s"</span> % (threadName, datetime.datetime.now()))</span><br><span class="line">        counter -= <span class="number">1</span></span><br><span class="line">        </span><br><span class="line">thread1 = my_Thread(<span class="number">1</span>, <span class="string">"Thread-1"</span>, <span class="number">1</span>)</span><br><span class="line">thread2 = my_Thread(<span class="number">2</span>, <span class="string">"Thread-2"</span>, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">thread1.start()</span><br><span class="line">thread2.start()</span><br><span class="line">thread1.join()</span><br><span class="line">thread2.join()</span><br></pre></td></tr></table></figure><p><strong>输出</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 输出</span></span><br><span class="line">开始线程：Thread<span class="number">-1</span></span><br><span class="line">开始线程：Thread<span class="number">-2</span></span><br><span class="line">Thread<span class="number">-1</span>: <span class="number">2018</span><span class="number">-04</span><span class="number">-25</span> <span class="number">20</span>:<span class="number">47</span>:<span class="number">20.066293</span></span><br><span class="line">Thread<span class="number">-2</span>: <span class="number">2018</span><span class="number">-04</span><span class="number">-25</span> <span class="number">20</span>:<span class="number">47</span>:<span class="number">21.059349</span></span><br><span class="line">Thread<span class="number">-1</span>: <span class="number">2018</span><span class="number">-04</span><span class="number">-25</span> <span class="number">20</span>:<span class="number">47</span>:<span class="number">21.066350</span></span><br><span class="line">Thread<span class="number">-1</span>: <span class="number">2018</span><span class="number">-04</span><span class="number">-25</span> <span class="number">20</span>:<span class="number">47</span>:<span class="number">22.066407</span></span><br><span class="line">Thread<span class="number">-2</span>: <span class="number">2018</span><span class="number">-04</span><span class="number">-25</span> <span class="number">20</span>:<span class="number">47</span>:<span class="number">23.069464</span></span><br><span class="line">Thread<span class="number">-1</span>: <span class="number">2018</span><span class="number">-04</span><span class="number">-25</span> <span class="number">20</span>:<span class="number">47</span>:<span class="number">23.070464</span></span><br><span class="line">Thread<span class="number">-1</span>: <span class="number">2018</span><span class="number">-04</span><span class="number">-25</span> <span class="number">20</span>:<span class="number">47</span>:<span class="number">24.102524</span></span><br><span class="line">退出线程：Thread<span class="number">-1</span></span><br><span class="line">Thread<span class="number">-2</span>: <span class="number">2018</span><span class="number">-04</span><span class="number">-25</span> <span class="number">20</span>:<span class="number">47</span>:<span class="number">25.070579</span></span><br><span class="line">Thread<span class="number">-2</span>: <span class="number">2018</span><span class="number">-04</span><span class="number">-25</span> <span class="number">20</span>:<span class="number">47</span>:<span class="number">27.070693</span></span><br><span class="line">Thread<span class="number">-2</span>: <span class="number">2018</span><span class="number">-04</span><span class="number">-25</span> <span class="number">20</span>:<span class="number">47</span>:<span class="number">29.070808</span></span><br><span class="line">退出线程：Thread<span class="number">-2</span></span><br></pre></td></tr></table></figure><h3 id="线程之间的同步"><a href="#线程之间的同步" class="headerlink" title="线程之间的同步"></a>线程之间的同步</h3><p>多线程同时对同一数据进行修改时，为保证数据正确，需要多线程同步。</p><p>多线程的优势在于可以同时运行多个任务（至少感觉起来是这样）。</p><blockquote><p>使用 Thread 对象的 Lock 和 Rlock 可以实现简单的线程同步，这两个对象都有 acquire 方法和 release 方法，对于那些需要每次只允许一个线程操作的数据，可以将其操作放到 acquire 和 release 方法之间。如下：</p><p>考虑这样一种情况：一个列表里所有元素都是0，线程”set”从后向前把所有元素改成1，而线程”print”负责从前往后读取列表并打印。</p><p>那么，可能线程”set”开始改的时候，线程”print”便来打印列表了，输出就成了一半0一半1，这就是数据的不同步。为了避免这种情况，引入了锁的概念。</p><p>锁有两种状态——锁定和未锁定。每当一个线程比如”set”要访问共享数据时，必须先获得锁定；如果已经有别的线程比如”print”获得锁定了，那么就让线程”set”暂停，也就是同步阻塞；等到线程”print”访问完毕，释放锁以后，再让线程”set”继续。</p><p>经过这样的处理，打印列表时要么全部输出0，要么全部输出1，不会再出现一半0一半1的尴尬场面。<br>——引自菜鸟教程，Python3 多线程</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">my_Thread</span> <span class="params">(threading.Thread)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, threadID, name, delay)</span>:</span></span><br><span class="line">        threading.Thread.__init__(self)</span><br><span class="line">        self.threadID = threadID</span><br><span class="line">        self.name = name</span><br><span class="line">        self.delay = delay</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">print</span> (<span class="string">"开始线程："</span> + self.name)</span><br><span class="line">        threadLock.acquire()</span><br><span class="line">        print_datetime(self.name, self.delay, <span class="number">5</span>)</span><br><span class="line">        threadLock.release()</span><br><span class="line">        <span class="keyword">print</span> (<span class="string">"退出线程："</span> + self.name)</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">print_datetime</span><span class="params">(threadName, delay, counter)</span>:</span></span><br><span class="line">    <span class="keyword">while</span> counter:</span><br><span class="line">        time.sleep(delay)</span><br><span class="line">        <span class="keyword">print</span> (<span class="string">"%s: %s"</span> % (threadName, datetime.datetime.now()))</span><br><span class="line">        counter -= <span class="number">1</span></span><br><span class="line"></span><br><span class="line">threadLock = threading.Lock()</span><br><span class="line">threads = []</span><br><span class="line">        </span><br><span class="line">thread1 = my_Thread(<span class="number">1</span>, <span class="string">"Thread-1"</span>, <span class="number">1</span>)</span><br><span class="line">thread2 = my_Thread(<span class="number">2</span>, <span class="string">"Thread-2"</span>, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">thread1.start()</span><br><span class="line">thread2.start()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加线程到线程列表</span></span><br><span class="line">threads.append(thread1)</span><br><span class="line">threads.append(thread2)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 等待所有线程完成</span></span><br><span class="line"><span class="keyword">for</span> t <span class="keyword">in</span> threads:</span><br><span class="line">    t.join()</span><br><span class="line"><span class="keyword">print</span> (<span class="string">"退出主线程"</span>)</span><br></pre></td></tr></table></figure><p><strong>输出</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">开始线程：Thread<span class="number">-1</span></span><br><span class="line">开始线程：Thread<span class="number">-2</span></span><br><span class="line">Thread<span class="number">-1</span>: <span class="number">2018</span><span class="number">-04</span><span class="number">-25</span> <span class="number">20</span>:<span class="number">59</span>:<span class="number">31.691139</span></span><br><span class="line">Thread<span class="number">-1</span>: <span class="number">2018</span><span class="number">-04</span><span class="number">-25</span> <span class="number">20</span>:<span class="number">59</span>:<span class="number">32.691196</span></span><br><span class="line">Thread<span class="number">-1</span>: <span class="number">2018</span><span class="number">-04</span><span class="number">-25</span> <span class="number">20</span>:<span class="number">59</span>:<span class="number">33.692254</span></span><br><span class="line">Thread<span class="number">-1</span>: <span class="number">2018</span><span class="number">-04</span><span class="number">-25</span> <span class="number">20</span>:<span class="number">59</span>:<span class="number">34.692311</span></span><br><span class="line">Thread<span class="number">-1</span>: <span class="number">2018</span><span class="number">-04</span><span class="number">-25</span> <span class="number">20</span>:<span class="number">59</span>:<span class="number">35.692368</span></span><br><span class="line">退出线程：Thread<span class="number">-1</span></span><br><span class="line">Thread<span class="number">-2</span>: <span class="number">2018</span><span class="number">-04</span><span class="number">-25</span> <span class="number">20</span>:<span class="number">59</span>:<span class="number">37.692482</span></span><br><span class="line">Thread<span class="number">-2</span>: <span class="number">2018</span><span class="number">-04</span><span class="number">-25</span> <span class="number">20</span>:<span class="number">59</span>:<span class="number">39.692597</span></span><br><span class="line">Thread<span class="number">-2</span>: <span class="number">2018</span><span class="number">-04</span><span class="number">-25</span> <span class="number">20</span>:<span class="number">59</span>:<span class="number">41.692711</span></span><br><span class="line">Thread<span class="number">-2</span>: <span class="number">2018</span><span class="number">-04</span><span class="number">-25</span> <span class="number">20</span>:<span class="number">59</span>:<span class="number">43.692826</span></span><br><span class="line">Thread<span class="number">-2</span>: <span class="number">2018</span><span class="number">-04</span><span class="number">-25</span> <span class="number">20</span>:<span class="number">59</span>:<span class="number">45.692940</span></span><br><span class="line">退出线程：Thread<span class="number">-2</span></span><br><span class="line">退出主线程</span><br></pre></td></tr></table></figure><p><strong>注意对比区别</strong></p><p>线程中还有线程优先级队列等，没有用到不介绍。</p><h2 id="多进程Multiprocessing"><a href="#多进程Multiprocessing" class="headerlink" title="多进程Multiprocessing"></a>多进程Multiprocessing</h2><h3 id="Process-类"><a href="#Process-类" class="headerlink" title="Process 类"></a>Process 类</h3><p>Process 类用来描述一个进程对象，用于新建子进程。创建子进程的时候，只需要传入一个执行函数和函数的参数即可完成 Process 示例的创建。</p><ul><li>start() 方法启动进程，</li><li>join() 方法实现进程间的同步，等待所有进程退出。</li><li>close() 用来阻止多余的进程涌入进程池 Pool 造成进程阻塞。</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> multiprocession</span><br><span class="line">multiprocessing.Process(group=<span class="keyword">None</span>, target=<span class="keyword">None</span>, name=<span class="keyword">None</span>, args=(), kwargs=&#123;&#125;, *,daemon=<span class="keyword">None</span>)</span><br></pre></td></tr></table></figure><ul><li><strong>target</strong> 是函数<strong>名字</strong>，需要调用的函数（只要名字）</li><li><strong>args</strong> 函数需要的参数，以 tuple 的形式传入</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> each_group <span class="keyword">in</span> url_groups:  <span class="comment"># 每组执行多线程下载</span></span><br><span class="line">    each_process = multiprocessing.Process(target=thread_run, args=(each_group,))</span><br><span class="line">    process.append(each_process)</span><br><span class="line"><span class="keyword">for</span> one_process <span class="keyword">in</span> process:</span><br><span class="line">    one_process.start()</span><br><span class="line"><span class="keyword">for</span> one_process <span class="keyword">in</span> process:</span><br><span class="line">one_process.join() <span class="comment"># 阻塞当前进程，直到调用join方法的那个进程执行完，再继续执行当前进程。</span></span><br></pre></td></tr></table></figure><h3 id="Pool类"><a href="#Pool类" class="headerlink" title="Pool类"></a>Pool类</h3><p>同时创建多个进程也可用Pool类</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">pool = multiprocessing.Pool(processes=<span class="number">4</span>) <span class="comment"># 创建4个进程</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">10</span>):</span><br><span class="line">    msg = <span class="string">"hello %d"</span> %(i)</span><br><span class="line">    pool.apply_async(func, (msg, ))</span><br><span class="line">pool.close() <span class="comment"># 关闭进程池，表示不能在往进程池中添加进程</span></span><br><span class="line">pool.join() <span class="comment"># 等待进程池中的所有进程执行完毕，必须在close()之后调用</span></span><br></pre></td></tr></table></figure><p><strong><em>pool.apply_async()</em></strong>是<strong><em>apply()</em></strong>的并行版本， <strong><em>apply()</em></strong>是<strong><em>apply_async()</em></strong>的阻塞版本，也是Python内置的函数，两者等价。在这个函数中输出结果并不是按照代码for循环中的顺序输出的。</p><p><strong><em>pool.apply_async(func, (msg, ))</em></strong>可返回值，它返回pool中所有进程的<strong>值的对象（注意是对象，不是值本身）</strong>。</p><h1 id="成果"><a href="#成果" class="headerlink" title="成果"></a>成果</h1><p><img src="https://github.com/qy19941014/blogimage/raw/master/img/arakiyuko1.png" alt="yuko1"><br><img src="https://github.com/qy19941014/blogimage/raw/master/img/arakiyuko2.jpg" alt="yuko2"><br><img src="https://github.com/qy19941014/blogimage/raw/master/img/arakiyuko3.jpg" alt="yuko3"><br><img src="https://github.com/qy19941014/blogimage/raw/master/img/arakiyuko4.jpg" alt="yuko4"><br><img src="https://github.com/qy19941014/blogimage/raw/master/img/arakiyuko5.jpg" alt="yukop5"><br><img src="https://github.com/qy19941014/blogimage/raw/master/img/arakiyuko6.jpg" alt="yuko6"></p><p>#源代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"><span class="keyword">import</span> urllib.request</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> threading <span class="keyword">import</span> Thread</span><br><span class="line"><span class="keyword">import</span> multiprocessing</span><br><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"></span><br><span class="line"><span class="string">'''断点续传程序'''</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_urls</span><span class="params">()</span>:</span></span><br><span class="line">    to_down = open(<span class="string">'weibo.csv'</span>, <span class="string">'r'</span>, encoding=<span class="string">'utf-8'</span>, newline=<span class="string">''</span>)</span><br><span class="line">    csv_data = csv.reader(to_down)</span><br><span class="line"></span><br><span class="line">    download_urls, downloaded_urls = [], []</span><br><span class="line">    count = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> data <span class="keyword">in</span> csv_data:</span><br><span class="line">        <span class="keyword">if</span> data[<span class="number">9</span>] == <span class="string">''</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        <span class="keyword">elif</span> len(data[<span class="number">9</span>].split(<span class="string">','</span>)):</span><br><span class="line">            <span class="comment"># 读入数据为urls字符串，去除无用字符转为url—list</span></span><br><span class="line">            <span class="keyword">for</span> num <span class="keyword">in</span> range(len(data[<span class="number">9</span>].split(<span class="string">','</span>))):</span><br><span class="line">                <span class="comment"># print(num)</span></span><br><span class="line">                download_urls.append(data[<span class="number">9</span>].split(</span><br><span class="line">                    <span class="string">','</span>)[num].strip(<span class="string">'['</span>).strip(<span class="string">']'</span>).strip(<span class="string">' '</span>).strip(<span class="string">'\''</span>))</span><br><span class="line">                print(str(count) + <span class="string">' Done!'</span>)</span><br><span class="line">                count = count + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">'Error'</span>)</span><br><span class="line">            </span><br><span class="line">    <span class="keyword">return</span> download_urls</span><br><span class="line"></span><br><span class="line"><span class="string">'''下载图片程序'''</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">download_pics</span><span class="params">(urls, thread_id)</span>:</span></span><br><span class="line">    folder_path = <span class="string">'''保存路径'''</span></span><br><span class="line">    fout = open(<span class="string">'failed_pics.txt'</span>, <span class="string">"a"</span>, encoding=<span class="string">'utf-8'</span>) 下载失败 保存链接</span><br><span class="line">    print(<span class="string">'thread: %d is running'</span> % (thread_id))</span><br><span class="line">    <span class="keyword">for</span> url <span class="keyword">in</span> urls:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            urllib.request.urlretrieve(url, folder_path + url.split(<span class="string">'/'</span>)[<span class="number">-1</span>])</span><br><span class="line">            time.sleep(<span class="number">1</span>)</span><br><span class="line">            print(<span class="string">'pic: '</span> + url.split(<span class="string">'/'</span>)[<span class="number">-1</span>] + <span class="string">' done!'</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            print(url, file=fout)  <span class="comment"># 下载失败 保存链接</span></span><br><span class="line">            print(<span class="string">'pic: '</span> + url.split(<span class="string">'/'</span>)[<span class="number">-1</span>] + <span class="string">' failed!'</span>)</span><br><span class="line">            </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">thread_run</span><span class="params">(download_urls)</span>:</span>  <span class="comment"># 多线程</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">10</span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            t = Thread(target=download_pics, args=(download_urls, i))</span><br><span class="line">            t.start()</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            print(<span class="string">'wrong'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">multi_process</span><span class="params">(urls)</span>:</span> <span class="comment"># 多进程</span></span><br><span class="line">    process = []</span><br><span class="line">    url_group_0 = []</span><br><span class="line">    url_group_1 = []</span><br><span class="line">    url_group_2 = []</span><br><span class="line">    url_group_3 = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> index <span class="keyword">in</span> range(len(urls)):  <span class="comment"># 将url分为四组</span></span><br><span class="line">        <span class="keyword">if</span> index % <span class="number">4</span> == <span class="number">0</span>:</span><br><span class="line">            url_group_0.append(urls[index])</span><br><span class="line">        <span class="keyword">elif</span> index % <span class="number">4</span> == <span class="number">1</span>:</span><br><span class="line">            url_group_1.append(urls[index])</span><br><span class="line">        <span class="keyword">elif</span> index % <span class="number">4</span> == <span class="number">2</span>:</span><br><span class="line">            url_group_2.append(urls[index])</span><br><span class="line">        <span class="keyword">elif</span> index % <span class="number">4</span> == <span class="number">3</span>:</span><br><span class="line">            url_group_3.append(urls[index])</span><br><span class="line">    url_groups = [url_group_0, url_group_1, url_group_2, url_group_3]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> each_group <span class="keyword">in</span> url_groups:  <span class="comment"># 每组分多个进程、线程下载</span></span><br><span class="line">        each_process = multiprocessing.Process(target=thread_run, args=(each_group,))</span><br><span class="line">        process.append(each_process)</span><br><span class="line">    <span class="keyword">for</span> one_process <span class="keyword">in</span> process:</span><br><span class="line">        one_process.start()</span><br><span class="line">    <span class="keyword">for</span> one_process <span class="keyword">in</span> process:</span><br><span class="line">        one_process.join()  <span class="comment"># 阻塞当前进程，直到调用join方法的那个进程执行完，再继续执行当前进程。</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    start_time = datetime.datetime.now()<span class="comment"># 用于统计时间</span></span><br><span class="line">    download_urls = get_urls()</span><br><span class="line">    multi_process(download_urls)</span><br><span class="line">    end_time = datetime.datetime.now()</span><br><span class="line">    print(end_time - start_time)</span><br></pre></td></tr></table></figure>]]></content>
      
      <categories>
          
          <category> 技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 技术 </tag>
            
            <tag> 多进程 </tag>
            
            <tag> 多线程 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>吉林大学外网成绩查询</title>
      <link href="/2018/04/25/2018-04-25-jlucjcx/"/>
      <url>/2018/04/25/2018-04-25-jlucjcx/</url>
      <content type="html"><![CDATA[<p>毕业后才弄出来，当时绩点5分一档我各种89真的恶心（还是自己不厉害），用于在吉林大学外网查询成绩，绩点等，可稍加改进后用于各种算法算绩点。<br><a id="more"></a></p><h1 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h1><p>用python写了个脚本，能把成绩都爬下来，然后各种算绩点的方法就可以用了（不过现在似乎没什么用，如果想的话可以把教学号密码写入了一键查)。只是为了试下模拟登录，当时发现传的加密密码放弃了，一直不懂怎么破解，后来突然发现是‘UIMS’+教学号+密码的md5加密，而且就写在网站的js代码里，uims没法登就不试了，不过那个好像比较难一点，现在加了个滑块，不然倒是可以写个自动教学评价的脚本- -</p><p>水平有限，强行用了类来实现，不过好像不怎么规范。。。</p><p>目标是通过小程序实现，看了下要学java什么的。。。python写的只能后台，这个都不太会，强行先占个坑吧。。以后再说= =</p><h1 id="源代码"><a href="#源代码" class="headerlink" title="源代码"></a>源代码</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_j_pwd</span><span class="params">(stu_id, pwd)</span>:</span></span><br><span class="line">    j_pwd = <span class="string">'UIMS'</span> + stu_id + pwd</span><br><span class="line">    m = hashlib.md5()</span><br><span class="line">    <span class="comment"># print(str)</span></span><br><span class="line">    m.update(j_pwd.encode(<span class="string">"utf8"</span>))  <span class="comment"># 否则编码不同</span></span><br><span class="line">    j_pwd = m.hexdigest()</span><br><span class="line">    <span class="keyword">return</span> j_pwd</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">generate_term_id</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="comment"># 生成2005到现在的term_id</span></span><br><span class="line">    current_year = time.localtime(time.time())[<span class="number">0</span>]</span><br><span class="line">    term, year_start, termID_start = <span class="number">1</span>, <span class="number">2005</span>, <span class="number">101</span></span><br><span class="line">    termID_dict = &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(year_start &lt;= current_year):</span><br><span class="line">        termID_dict[str(termID_start)] = str(year_start) + \</span><br><span class="line">            <span class="string">' - '</span> + str(year_start + <span class="number">1</span>) + <span class="string">'学年第'</span> + str(term) + <span class="string">'学期'</span></span><br><span class="line">        term = term + <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span>(year_start &lt; <span class="number">2013</span>):  <span class="comment"># 2013年前有3个学期</span></span><br><span class="line">            <span class="keyword">if</span>(term == <span class="number">4</span>):</span><br><span class="line">                term = <span class="number">1</span></span><br><span class="line">                year_start = year_start + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">if</span>(term == <span class="number">3</span>):</span><br><span class="line">                term = <span class="number">1</span></span><br><span class="line">                year_start = year_start + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        termID_start = termID_start + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    print(<span class="string">u'ID\t学期'</span>)</span><br><span class="line">    <span class="keyword">for</span> key, item <span class="keyword">in</span> termID_dict.items():</span><br><span class="line">        print(key, <span class="string">u'\t'</span>, item)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">JLU_CJCX</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, stu_id, j_pwd)</span>:</span></span><br><span class="line">        self.url_secucheck = <span class="string">'http://cjcx.jlu.edu.cn/score/action/security_check.php'</span>  <span class="comment"># 密码验证网址</span></span><br><span class="line">        self.url_score = <span class="string">'http://cjcx.jlu.edu.cn/score/action/service_res.php'</span>  <span class="comment"># 成绩查询网址</span></span><br><span class="line">        self.headers = &#123;</span><br><span class="line">            <span class="string">'Connection'</span>: <span class="string">'keep-alive'</span>,</span><br><span class="line">            <span class="string">'Referer'</span>: <span class="string">'http://cjcx.jlu.edu.cn/score/userLogin.php'</span>,</span><br><span class="line">            <span class="string">'User-Agent'</span>: <span class="string">'Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3386.1 Safari/537.36'</span>,</span><br><span class="line">        &#125;  <span class="comment"># requests请求头</span></span><br><span class="line">        self.post_data = &#123;</span><br><span class="line">            <span class="string">'j_username'</span>: stu_id,</span><br><span class="line">            <span class="string">'j_password'</span>: j_pwd,</span><br><span class="line">        &#125;</span><br><span class="line">        self.stu_id = stu_id</span><br><span class="line">        self.reuqest_session = requests.Session()  <span class="comment"># 需要保存cookies 构建session</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">log_in</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.reuqest_session.headers.update(self.headers)</span><br><span class="line">        temp = self.reuqest_session.post(</span><br><span class="line">            self.url_secucheck, data=self.post_data).text</span><br><span class="line">        self.reuqest_session.cookies.update(self.reuqest_session.cookies)</span><br><span class="line">        <span class="keyword">if</span> temp[<span class="number">1</span>] == <span class="string">'!'</span>:  <span class="comment"># 检测返回网页第一个数值 若成功则为！</span></span><br><span class="line">            print(<span class="string">'登录成功！'</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">True</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">'登录失败'</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">False</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod  # 静态方法 在另一个方法中调用</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_term_id</span><span class="params">()</span>:</span></span><br><span class="line">        term_id = int(input(<span class="string">'请输入要查询学期的id（查询所有学期：0，查看id：1，退出：-1: '</span>))</span><br><span class="line">        <span class="keyword">while</span>(term_id == <span class="number">1</span>):</span><br><span class="line">            generate_term_id()</span><br><span class="line">            term_id = int(input(<span class="string">'请输入要查询学期的id（查询所有学期：0，查看id：1，退出：-1: '</span>))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> term_id</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_score</span><span class="params">(self)</span>:</span></span><br><span class="line">        term_id = self.get_term_id()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> term_id == <span class="number">0</span>:  <span class="comment"># 查所有学期</span></span><br><span class="line">            post_term_id = json.dumps(&#123;<span class="string">'tag'</span>: <span class="string">'lessonSelectResult@oldStudScore'</span>, <span class="string">'params'</span>: &#123;</span><br><span class="line">                                      <span class="string">'xh'</span>: self.stu_id&#125;&#125;)  <span class="comment"># json.dumps()用于将dict类型的数据转成str</span></span><br><span class="line">        <span class="keyword">elif</span> term_id &gt; <span class="number">1</span>:</span><br><span class="line">            post_term_id = json.dumps(&#123;<span class="string">'tag'</span>: <span class="string">'lessonSelectResult@oldStudScore'</span>, <span class="string">'params'</span>: &#123;</span><br><span class="line">                                      <span class="string">'xh'</span>: self.stu_id, <span class="string">'termId'</span>: term_id&#125;&#125;)  <span class="comment"># json.dumps()用于将dict类型的数据转成str</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">'退出'</span>)</span><br><span class="line">            exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">        response = self.reuqest_session.post(self.url_score, data=post_term_id)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> response</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">UI</span><span class="params">(self)</span>:</span></span><br><span class="line">        has_log_in = self.log_in()</span><br><span class="line">        <span class="keyword">if</span> has_log_in == <span class="keyword">False</span>:  <span class="comment"># 登录失败退出</span></span><br><span class="line">            os.system(<span class="string">'pause'</span>)</span><br><span class="line">            exit(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            generate_term_id()</span><br><span class="line">        <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">            score_data = self.get_score()</span><br><span class="line">            score_data = score_data.content.decode(<span class="string">'utf-8'</span>)  <span class="comment"># 数据经过utf8编码</span></span><br><span class="line">            score_data = json.loads(score_data)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> score_data[<span class="string">'count'</span>] == <span class="number">0</span>:</span><br><span class="line">                print(<span class="string">'查询成绩失败'</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                print(<span class="string">u'课程名称\t\t\t成绩\t学分\t绩点\t重修'</span>)</span><br><span class="line">                <span class="keyword">for</span> item <span class="keyword">in</span> score_data[<span class="string">'items'</span>]:</span><br><span class="line">                    print(<span class="string">'&#123;kcmc:&lt;&#123;len&#125;&#125;\t'</span>.format(kcmc=(item[<span class="string">"kcmc"</span>][:<span class="number">15</span>]), len=<span class="number">25</span> - len((item[<span class="string">"kcmc"</span>][:<span class="number">15</span>]).encode(<span class="string">'GBK'</span>)) + len(</span><br><span class="line">                        (item[<span class="string">"kcmc"</span>][:<span class="number">15</span>]))), item[<span class="string">"cj"</span>], <span class="string">'\t'</span>, item[<span class="string">"credit"</span>], <span class="string">'\t'</span>, item[<span class="string">"gpoint"</span>], <span class="string">'\t'</span>, item[<span class="string">"isReselect"</span>])</span><br><span class="line">                    <span class="comment"># 为了格式对齐</span></span><br><span class="line"></span><br><span class="line">            os.system(<span class="string">'pause'</span>)  <span class="comment"># 任意键继续</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    stu_id = input(<span class="string">'教学号：'</span>)</span><br><span class="line">    pwd = input(<span class="string">'密码：'</span>)</span><br><span class="line">    j_pwd = get_j_pwd(stu_id, pwd)</span><br><span class="line">    jlu_cjcx = JLU_CJCX(stu_id, j_pwd)</span><br><span class="line">    jlu_cjcx.UI()</span><br></pre></td></tr></table></figure>]]></content>
      
      <categories>
          
          <category> 技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 爬虫 </tag>
            
            <tag> 模拟登录 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>学习笔记之爬虫(2):豆瓣电影top250</title>
      <link href="/2018/01/16/2016-01-06-douban/"/>
      <url>/2018/01/16/2016-01-06-douban/</url>
      <content type="html"><![CDATA[<h1 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h1><p>学了两星期了，在此之前看的比较散，原理上太薄弱，所以想重新学一下，目前还是用BeautifulSoup和requests来做，很大一部分网站都能够顺利解析并获取想要的数据，试了小猪，58同城，现在自已写了豆瓣的爬虫，就当是对刚学知识的巩固，积累经验，并做下一部学习的准备。（就不说今天兴致勃勃爬微博，结果发现微博数据全是由js加载时那种想哭的冲动了，我学还不行嘛）<br><a id="more"></a><br>就按我写的思路贴代码吧</p><h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><p>先列出所有用到的库（当然这是在写的过程中慢慢加的）</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Pool</span><br></pre></td></tr></table></figure><p>初始设置的一些参数</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">start_url = <span class="string">'https://movie.douban.com/top250'</span> <span class="comment"># 初始url</span></span><br><span class="line"><span class="comment"># https://movie.douban.com/top250?start=0&amp;filter= # 分析url组成</span></span><br><span class="line">fieldnames = [<span class="string">'title'</span>, <span class="string">'director'</span>,<span class="string">'year'</span>,<span class="string">'rate'</span>,<span class="string">'desc'</span>,<span class="string">'popu'</span>] <span class="comment"># csv表头 输入dict与输出csv对应关系</span></span><br><span class="line"><span class="comment"># 用于伪装成浏览器</span></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">'User-Agent'</span>:<span class="string">''</span>,</span><br><span class="line">    <span class="string">'Cookie'</span>:<span class="string">''</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>首先是要获取所有待爬取的链接，发现这是可以从页面底部的页码中获取的，不过没有当前页面，需要额外添加</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''获取所有待爬取url函数'''</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_all_links</span><span class="params">(url)</span>:</span></span><br><span class="line">    wb_data = requests.get(url,headers = headers)</span><br><span class="line">    soup = BeautifulSoup(wb_data.text, <span class="string">'lxml'</span>)</span><br><span class="line">    links = soup.select(<span class="string">'div.paginator &gt; a'</span>)</span><br><span class="line"></span><br><span class="line">    all_links = []</span><br><span class="line">    all_links.append(start_url) <span class="comment"># 没有这一条会错过top25</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> link <span class="keyword">in</span> links:</span><br><span class="line">        <span class="comment"># print(link.get('href'))</span></span><br><span class="line">        all_links.append(start_url + link.get(<span class="string">'href'</span>)) <span class="comment">#将相对地址变成绝对地址</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># print(all_links) #用于测试</span></span><br><span class="line">    <span class="keyword">return</span> all_links</span><br></pre></td></tr></table></figure><p>然后是对单一页面进行分析，构建函数提取数据，这一过程是最麻烦，但也是最有趣的。用到的工具可以有很多就看基本功和智商了233</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''获取单页信息函数'''</span></span><br><span class="line"><span class="string">'''!important,实际使用过程中发现，有的电影没有description时，之后的desc会错位，并错过当页最后一个电影'''</span></span><br><span class="line"><span class="string">'''目前没有太有效办法，想到的就是从上一级就获取数据，这样无非就是再复杂化筛选过程，不太经济，保留bug'''</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_one_page_info</span><span class="params">(url)</span>:</span></span><br><span class="line">    wb_data = requests.get(url,headers = headers)</span><br><span class="line">    soup = BeautifulSoup(wb_data.text, <span class="string">'lxml'</span>)</span><br><span class="line">    titles = soup.select(<span class="string">'div.hd &gt; a'</span>)</span><br><span class="line">    directors = soup.select(<span class="string">'div.bd &gt; p:nth-of-type(1)'</span>)</span><br><span class="line">    years = soup.select(<span class="string">'div.bd &gt; p:nth-of-type(1)'</span>)</span><br><span class="line">    rates = soup.select(<span class="string">'span.rating_num'</span>)</span><br><span class="line">    descs = soup.select(<span class="string">'div.bd &gt; p.quote &gt; span'</span>)</span><br><span class="line">    popus = soup.select(<span class="string">'div.bd &gt; div &gt; span:nth-of-type(4)'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># print(names,directors,years,rates,descs)</span></span><br><span class="line">    data_list = []</span><br><span class="line">    <span class="keyword">for</span> title,director,year,rate,desc,popu <span class="keyword">in</span> zip(titles,directors,years,rates,descs,popus):</span><br><span class="line">        <span class="comment"># 调试用函数,可以对每一项先打印其字符串形式，然后再想办法选出数据    </span></span><br><span class="line">        <span class="comment"># print(repr(year.get_text())) # 以字符串样式打印，便于筛选数据</span></span><br><span class="line">        <span class="comment"># print(re.findall(r'\d+',year.get_text()))</span></span><br><span class="line">        <span class="comment"># print(desc.get_text().strip('\n'))</span></span><br><span class="line">        <span class="comment"># print("===") # 分隔</span></span><br><span class="line">        <span class="comment"># date = re.findall(r'\d+',year.get_text())</span></span><br><span class="line">        time.sleep(<span class="number">3</span>)</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">'title'</span>: title.get_text().strip(<span class="string">'\n'</span>).replace(<span class="string">'\n\xa0'</span>,<span class="string">' '</span>).replace(<span class="string">'\xa0'</span>,<span class="string">' '</span>), <span class="comment"># 替换掉无关字符</span></span><br><span class="line">            <span class="string">'director'</span>: director.get_text().strip(<span class="string">'\n'</span>).strip().split(<span class="string">'\xa0\xa0\xa0'</span>)[<span class="number">0</span>],</span><br><span class="line">            <span class="string">'year'</span>: re.findall(<span class="string">r'\d+'</span>,year.get_text())[<span class="number">0</span>],<span class="comment"># 正则表达式，选出数字</span></span><br><span class="line">            <span class="string">'rate'</span>: rate.get_text(),</span><br><span class="line">            <span class="string">'desc'</span>: desc.get_text().strip(<span class="string">'\n'</span>),</span><br><span class="line">            <span class="string">'popu'</span>: re.findall(<span class="string">r'\d+'</span>,popu.get_text())[<span class="number">0</span>],</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"># print(data)</span></span><br><span class="line">        data_list.append(data)</span><br><span class="line">    <span class="keyword">return</span> data_list</span><br><span class="line"><span class="comment"># get_one_page_info('https://movie.douban.com/top250?start=100&amp;filter=') # 用于测试</span></span><br></pre></td></tr></table></figure><p>由于数据规模小，重点是数据库没用熟，因此想到输出成csv文件，为了避免数据爬完后丢失，想办法爬一页写入一页，用追加方式打开，使光标位于文尾。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''写入csv文件函数'''</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dict_writer</span><span class="params">(dict_datas,fieldnames)</span>:</span></span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">'top250.csv'</span>, <span class="string">'a'</span>,encoding = <span class="string">'utf-8'</span>,newline = <span class="string">''</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="comment"># 'a' 以追加方式打开文件，encoding 则是因为有中文，newline防止输出额外空行</span></span><br><span class="line">        <span class="comment"># fieldnames = ['title', 'director','year','rate','desc']</span></span><br><span class="line">        writer = csv.DictWriter(f, fieldnames=fieldnames)</span><br><span class="line"></span><br><span class="line">        <span class="comment">#writer.writeheader() # 写表头</span></span><br><span class="line">        <span class="keyword">for</span> dict_data <span class="keyword">in</span> dict_datas:</span><br><span class="line">            writer.writerow(dict_data)</span><br></pre></td></tr></table></figure><p>最后便是综合以上的，写出一个函数用于遍历并爬取所有的url，并后期测试了多进程爬取</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''获取所有信息函数'''</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_pages_info</span><span class="params">(url)</span>:</span></span><br><span class="line">    all_links = get_all_links(url)</span><br><span class="line">    </span><br><span class="line">    data = []</span><br><span class="line">    <span class="keyword">for</span> link <span class="keyword">in</span> all_links:</span><br><span class="line">        data = get_one_page_info(link)</span><br><span class="line">        dict_writer(data,fieldnames)</span><br><span class="line">        print(<span class="string">'One page done!'</span>) <span class="comment"># 提示一页完成</span></span><br><span class="line">        time.sleep(<span class="number">5</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="string">'''用于多进程测试'''</span></span><br><span class="line">    <span class="comment"># data = get_one_page_info(url)</span></span><br><span class="line">    <span class="comment"># dict_writer(data,fieldnames)</span></span><br><span class="line">    <span class="comment"># print('One page done!') # 提示一页完成</span></span><br><span class="line">    <span class="comment"># time.sleep(5)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    get_pages_info(start_url)</span><br><span class="line">    <span class="string">'''用于多进程测试'''</span>    </span><br><span class="line">    <span class="comment"># all_links = get_all_links(start_url)</span></span><br><span class="line">    <span class="comment"># pool = Pool() # 创建进程池</span></span><br><span class="line">    <span class="comment"># pool.map(get_pages_info,all_links)</span></span><br></pre></td></tr></table></figure><p>多进程爬虫的测试是成功的（速度提高了4倍），但由于电影有排名先后，多进程时会导到输出到文件的排名会有问题（就是各页的顺序错乱），因此注释用于以后参考</p><h1 id="存在的问题"><a href="#存在的问题" class="headerlink" title="存在的问题"></a>存在的问题</h1><ol><li><p><strong>python基础知识薄弱</strong></p><p>由于看了没多久，第一次做实用点的，以后多练习，并了解熟悉python的各种特性</p></li><li><p><strong>网页知识薄弱</strong></p></li></ol><p>争取多练习吧。然后有空要补下正则，网页，数据库的知识，并熟悉目前使用的各种库，工作量还是很大的。</p><p>进阶的话。。。争取吧，目前还是巩固为主</p>]]></content>
      
      <categories>
          
          <category> 技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 技术 </tag>
            
            <tag> 爬虫 </tag>
            
            <tag> 学习笔记 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>学习笔记之爬虫(1):异步加载数据的爬取</title>
      <link href="/2018/01/15/2018-1-15-crawler1/"/>
      <url>/2018/01/15/2018-1-15-crawler1/</url>
      <content type="html"><![CDATA[<h1 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h1><p>经过两天的学习终于完成了第一个稍微实用的爬虫，用15秒爬下了50张（哭）霉霉的图片。。。感谢仁慈的网站网开一面，由于学艺不精，暂时没加反反爬手段，只爬了前三页用于测试。实际测试已经成功，所以顺便复习下这几天学习的成果。<br><a id="more"></a></p><h1 id="网页信息的的获取"><a href="#网页信息的的获取" class="headerlink" title="网页信息的的获取"></a>网页信息的的获取</h1><p>目前所学习的还只是通过requests来得到网页，并用BeautifulSoup调取lxml html解析器来获取网页数据 （还有效率更高的正则表达式及lxml模块）。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url =<span class="string">''</span></span><br><span class="line">header = &#123;</span><br><span class="line">    <span class="string">'User-Agent'</span>:<span class="string">''</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># 'User-Agent'用于伪装成浏览器正常访问</span></span><br><span class="line"></span><br><span class="line">wb_data = requests.get(url,headers = header)</span><br><span class="line">soup = BeautifulSoup(wb_data.text,<span class="string">'lxml'</span>)</span><br><span class="line"><span class="comment"># .text是用于获取网页的文本类型数据</span></span><br><span class="line"><span class="comment">#'lxml'即调用lxml html解析器</span></span><br></pre></td></tr></table></figure></p><h1 id="网页元素的筛选"><a href="#网页元素的筛选" class="headerlink" title="网页元素的筛选"></a>网页元素的筛选</h1><p>BeautifulSoup支持CSSselector，因此可使用<strong><em>.select()</em></strong>,技术方法用CSS选择器的语法找到存有信息的标签<br>目前有两种方法来选择<strong><em>.select()</em></strong>的参数（要具有唯一性特征）</p><ul><li><strong>CSSselector</strong><br>直接在Chrome检查元素后<em>copy -&gt; selector</em>，然后选择到需要元素的父标签。<br>这里遇到的问题是需要把<em>nth:child</em>改成<em>nth-of-type</em>然后就查了下这两个的区别，相比较<em>nth-of-type</em>条件更少。</li></ul><table><thead><tr><th>选择器</th><th>条件</th></tr></thead><tbody><tr><td>nth-child</td><td>这是个段落元素且它父标签的第二个孩子元素(<strong><em>\&lt;p></em></strong>标签)</td></tr><tr><td>nth-of-type</td><td>父标签的第二个段落子元素(<strong><em>\&lt;p></em></strong>标签)</td></tr></tbody></table><p>但后来由于要选取所有的同类标签，所以并没有在这个问题上多作纠结。</p><ul><li><strong>标签名</strong><br>是当标签名唯一时，可以使用标签名的形式来进行选择数据</li></ul><h1 id="获取数据的打包"><a href="#获取数据的打包" class="headerlink" title="获取数据的打包"></a>获取数据的打包</h1><p>一个网页通过上述步骤，通常能获取许多不同链接，然后便通过循环来获得不同的数据，对于多个数据的循环用到了zip函数。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 用于将可迭代的对象作为参数，将对象中对应的元素打包成一个个元组，然后返回由这些元组组成的列表。如果各个迭代器的元素个数不一致，则返回列表长度与最短的对象相同。</span></span><br><span class="line">zip([iterable, ...])</span><br><span class="line">zip(*zipped_list) <span class="comment">#逆操作</span></span><br></pre></td></tr></table></figure></p><p>然后是获取数据，一般分为两类，对于标题，分类等文本信息，使用<strong><em>.get_text()</em></strong>方法获取，而对于图片或链接等则用<strong><em>.get(‘link’)</em></strong>获取，link为链接所在的属性，如src,href等。这其中涉及到的list和dict的操作不多说。在获取数据后再进一步根据下一步操作选择存储信息的方式，存于list,dict等</p><h1 id="多页信息的爬取"><a href="#多页信息的爬取" class="headerlink" title="多页信息的爬取"></a>多页信息的爬取</h1><p>目前主要涉及静态网页，通过观察链接的变化，设置循环来对多页网页进行爬取，此时由于访问过于频繁，可能会触发网站的反爬虫机制，一个简单的办法是通过<strong><em>time.sleep()</em></strong>方法来设置访问间隔</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">time.sleep(<span class="number">2</span>) <span class="comment"># 程序停止2秒</span></span><br></pre></td></tr></table></figure><h1 id="动态加载数据的提取"><a href="#动态加载数据的提取" class="headerlink" title="动态加载数据的提取"></a>动态加载数据的提取</h1><p>现在很多网站用动态加载，如新浪微博的评论，可以随鼠标的点击滚轮的运动，不停加载内容。这一过程是通过JS来完成的。<br>对于这类网页的爬取，需要用浏览器的监视功能中（<strong><em>NETWORK -&gt; XHR</em></strong>)，在网页动态加载的过程中，查看加载的规律，对于内容的提取也应该是这样，<strong><em>检查</em></strong>加载的内容，然后分析网页中多出的html代码进而执行与之前相同的爬取步骤。</p><h1 id="网页的下载"><a href="#网页的下载" class="headerlink" title="网页的下载"></a>网页的下载</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> urllib.request</span><br><span class="line">urllib.request.urlretrieve(url, filename=<span class="keyword">None</span>, reporthook=<span class="keyword">None</span>, data=<span class="keyword">None</span>)</span><br></pre></td></tr></table></figure><ul><li>参数<em>filename</em>指定了保存本地路径（如果参数未指定，urllib会生成一个临时文件保存数据。）</li><li>参数<em>reporthook</em>是一个回调函数，当连接上服务器、以及相应的数据块传输完毕时会触发该回调，我们可以利用这个回调函数来显示当前的下载进度。</li><li>参数<em>data</em>指post导服务器的数据，该方法返回一个包含两个元素的(<em>filename</em>, <em>headers</em>) 元组，<em>filename</em> 表示保存到本地的路径，<em>header</em>表示服务器的响应头</li></ul><p>在爬取霉霉图片时定义图片文件名时还用了split方法</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># str.split(str="", num=string.count(str)).</span></span><br><span class="line"><span class="comment"># str设定的分隔符，默认为所有的空字符，包括空格、换行(\n)、制表符(\t)等。</span></span><br><span class="line"><span class="comment"># num 表示分割次数。</span></span><br><span class="line">&gt;&gt;&gt;str = <span class="string">'misad is'</span></span><br><span class="line">&gt;&gt;&gt;<span class="keyword">print</span> (str.split(<span class="string">'i'</span>,<span class="number">1</span>))</span><br><span class="line">[<span class="string">'m'</span>,<span class="string">'sad is'</span>]</span><br></pre></td></tr></table></figure><h1 id="Show-me-the-code"><a href="#Show-me-the-code" class="headerlink" title="Show me the code"></a>Show me the code</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 动态数据提取</span></span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">import</span> requests, urllib.request</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url = <span class="string">'https://weheartit.com/inspirations/taylorswift?scrolling=true&amp;page='</span></span><br><span class="line">header = &#123;</span><br><span class="line">    <span class="string">'User-Agent'</span>: <span class="string">''</span>,</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_page</span><span class="params">(url, data = None)</span>:</span></span><br><span class="line">    wb_data = requests.get(url,headers = header)</span><br><span class="line">    soup = BeautifulSoup(wb_data.text, <span class="string">'lxml'</span>)</span><br><span class="line">    imgs = soup.select(<span class="string">'img.entry-thumbnail'</span>)</span><br><span class="line"></span><br><span class="line">    one_page_img_url = []</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> img <span class="keyword">in</span> imgs:</span><br><span class="line">        one_page_img_url.append(img.get(<span class="string">'src'</span>) )</span><br><span class="line"></span><br><span class="line">    print(one_page_img_url)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> one_page_img_url</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_more_pages</span><span class="params">(start,end)</span>:</span></span><br><span class="line">    imgs_url = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> one <span class="keyword">in</span> range(start,end):</span><br><span class="line">        one_page_img_url = get_page(url+str(one))</span><br><span class="line">        time.sleep(<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">        imgs_url.extend(one_page_img_url)</span><br><span class="line"></span><br><span class="line">    print(imgs_url)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> imgs_url</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">download_links</span><span class="params">(links)</span>:</span></span><br><span class="line">    folder_path = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> link <span class="keyword">in</span> links:</span><br><span class="line">        urllib.request.urlretrieve(link, folder_path + link.split(<span class="string">'/'</span>)[<span class="number">-2</span>] + link.split(<span class="string">'/'</span>)[<span class="number">-1</span>])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">imgs_url = get_more_pages(<span class="number">1</span>,<span class="number">3</span>)</span><br><span class="line">download_links(imgs_url)</span><br></pre></td></tr></table></figure>]]></content>
      
      <categories>
          
          <category> 技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 技术 </tag>
            
            <tag> 爬虫 </tag>
            
            <tag> 学习笔记 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>学习笔记之数据可视化（1）：世界GDP图_Pygal</title>
      <link href="/2018/01/11/2018-01-11-pygal/"/>
      <url>/2018/01/11/2018-01-11-pygal/</url>
      <content type="html"><![CDATA[<h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>这几天在看爬虫，感觉现在黄金时期已经过去了，各网站反爬的手段也是越来越高明了，昨天就多访问了某网几ip就被封了，所以这上面的学习可能需要蛮久，战线会很长。所以就顺便先做做数据可视化吧，为以后做准备。此文先作个引子，希望以后加强学习多敲代码。</p><a id="more"></a><h2 id="2016全球GDP图"><a href="#2016全球GDP图" class="headerlink" title="2016全球GDP图"></a>2016全球GDP图</h2><p>在世界银行网站上下了世界GDP从1960-2016的数据，然后使用pygal中提供的图表类型Worldmap，制作呈现各图数据的世界地图(.svg文件)。在本地打开鼠标悬停可显示数据</p><hr><p><img src="https://github.com/qy19941014/blogimage/raw/master/img/GDPMap.png" alt="GDPMap"><br><img src="https://github.com/qy19941014/blogimage/raw/master/img/GDPMap2.png" alt="GDPMap2"></p><hr><h3 id="文件编码"><a href="#文件编码" class="headerlink" title="文件编码"></a>文件编码</h3><p>还没开始处理数据就遇到问题了<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt;<span class="keyword">with</span> open(filename) <span class="keyword">as</span> f:</span><br></pre></td></tr></table></figure></p><p>提示错误<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UnicodeDecodeError: &apos;gbk&apos; codec can&apos;t decode bytes 0xbf in position 2: illegal multibyte sequence．</span><br></pre></td></tr></table></figure></p><p>这是由于python3默认解码方式失败导致的，比如它可能发现了中文用gbk去解码，但文本是utf-8的所以会失败，因此，只需要在打开文件时指定解码方式就可以解决。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt;<span class="keyword">with</span> open(filename,encoding=<span class="string">'UTF-8'</span>) <span class="keyword">as</span> f:</span><br></pre></td></tr></table></figure></p><h3 id="迭代器切片"><a href="#迭代器切片" class="headerlink" title="迭代器切片"></a>迭代器切片</h3><p>由于下载数据是从第四行开始有数据的，每次在循环中判断将加在时间开销，因此需要另想办法来处理。经过查看文档<strong><em>csv.reader()</em></strong>发现返回数据是一个迭代器，就想到了处理迭代器中的函数<strong><em>islice()</em></strong><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt;<span class="comment"># islice用于切片操作</span></span><br><span class="line">&gt;&gt;&gt;islice(iterable, [start,] stop [, step]) </span><br><span class="line">&gt;&gt;&gt;<span class="comment">#iterable可迭代变量，start起始值可省略，stop终止值，step步长</span></span><br></pre></td></tr></table></figure></p><h3 id="列出索引"><a href="#列出索引" class="headerlink" title="列出索引"></a>列出索引</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt;head_row = next(gdp_data)</span><br><span class="line">&gt;&gt;&gt;<span class="keyword">for</span> index,column_header <span class="keyword">in</span> enumerate(head_row): <span class="comment">#列出索引</span></span><br><span class="line"><span class="meta">... </span>   print(index, column_header)</span><br></pre></td></tr></table></figure><p>可以列出文件头及索引，这样就可以方便获取数据。其中<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">enumerate(iterable, [start=<span class="number">0</span>])</span><br><span class="line"><span class="comment"># iterable -- 序列、迭代器或其他可迭代对象。</span></span><br><span class="line"><span class="comment"># start -- 下标起始值。</span></span><br></pre></td></tr></table></figure></p><h3 id="数据处理"><a href="#数据处理" class="headerlink" title="数据处理"></a>数据处理</h3><h4 id="国别码处理"><a href="#国别码处理" class="headerlink" title="国别码处理"></a>国别码处理</h4><p>数据处理的话就是要从一行行数据中取出所需要的国家名和对就年分的GDP值，并组成字典。<br>这其中有个问题就是Pygal中使用两个字母的国别码，而在文件中是三个字母的，这需要使用 <strong><em>pygal.maps.world.COUNTRIES:</em></strong> 中的字典 <strong><em>COUNTRIES</em></strong> 进行转换(pygal - 2.0.0 以前此字典的模组<strong><em>pygal.i18n</em></strong>中)，因此使用2.0.0以后版本可以这样来使用相应模组</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># pip install pygal_maps_world. </span></span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;<span class="keyword">from</span> pygal.maps.world <span class="keyword">import</span> COUNTRIES</span><br><span class="line"><span class="comment"># from pygal_maps_world import i18n</span></span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;<span class="function"><span class="keyword">def</span> <span class="title">get_country_code</span><span class="params">(country_name)</span>:</span></span><br><span class="line"><span class="meta">... </span>   <span class="keyword">for</span> code,name <span class="keyword">in</span> COUNTRIES.items(): </span><br><span class="line"><span class="meta">... </span>   <span class="comment"># items()方法把字典中每对key和value组成一个元组，并把这些元组放在列表中返回。</span></span><br><span class="line"><span class="meta">... </span>       <span class="keyword">if</span> name == country_name:</span><br><span class="line"><span class="meta">... </span>           <span class="keyword">return</span> code</span><br><span class="line"><span class="meta">... </span>   <span class="keyword">return</span> <span class="keyword">None</span></span><br></pre></td></tr></table></figure><h4 id="GDP数值处理"><a href="#GDP数值处理" class="headerlink" title="GDP数值处理"></a>GDP数值处理</h4><p>在获取GDP过程中，需要对读入数据进行处理，把字符串str类型转换成float类型用于Pygal作图，但直接转换会有问题，由于有的国家2016年的GDP数据缺失，导入数据是空字符，若<strong><em>float(‘’)</em></strong>会出现<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">could not convert string to float # 不能把字符串转换为浮点类型的错误</span><br></pre></td></tr></table></figure></p><p>我加入了if循环将空字符变为<strong><em>‘0’</em></strong>在此过程中，可能有时字符中有特殊字符导致转换失败，可以用<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt;print(repr(string))</span><br></pre></td></tr></table></figure></p><p>以字符串形式打印数据，检查是否包含数字以外字符，再找办法处理</p><p>在获取GDP数值后还可以对GDP数值进行分类，以便显示时细化区分</p><h3 id="绘图"><a href="#绘图" class="headerlink" title="绘图"></a>绘图</h3><p>绘图时需要用到基本的pygal知识，这个想另外介绍，因为目前知道的也有限，仅说本文用的几行程序</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt;wm = pygal.maps.world.World() <span class="comment"># 构建地图</span></span><br><span class="line">&gt;&gt;&gt;wm_style = RotateStyle(<span class="string">'#336699'</span>) <span class="comment"># 设置图表颜色 16进制颜色</span></span><br><span class="line">&gt;&gt;&gt;wm = pygal.maps.world.World(style = wm_style)</span><br><span class="line">&gt;&gt;&gt;wm.title = <span class="string">'World GDP in 2016,by country'</span> <span class="comment"># 图表标题</span></span><br><span class="line">&gt;&gt;&gt;wm.add(<span class="string">'GDP'</span>,Country_GDP) <span class="comment"># 导入数据</span></span><br><span class="line">&gt;&gt;&gt;wm.render_to_file(<span class="string">'world gdp.svg'</span>) <span class="comment"># 生成svg文件</span></span><br></pre></td></tr></table></figure>]]></content>
      
      <categories>
          
          <category> 学习笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Pygal </tag>
            
            <tag> 数据可视化 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>听录习总10.25新闻见面会发言</title>
      <link href="/2017/10/26/2017-10-26-pressmeeting/"/>
      <url>/2017/10/26/2017-10-26-pressmeeting/</url>
      <content type="html"><![CDATA[<p>常委见面会讲话发言的英文，小哥读得实在是标准得不行，虽然不是美音或者英音，但能这样子真的也是超级棒了，听录下来学习下。<br><a id="more"></a><br>Ladies and gentleman, comrades and friends<br>Good morning<br>The 19th national congress of the Communist Party of China was concluded yesterday. The party congress has received extensive and detailed reporting via friends from the press, with many of you coming from afar. You have worked very hard and your media coverage has captured the attention of the world. I want to say a big thank you to you all.<br>Since the opening of the party congress, 452 major political parties and 165 countries have sent 855 messages of congratulation. Of these 814 came from heads of state or government or the leaders of political parties or important organizations. On behalf of the CPC central committee, I wish to convey our sincere appreciation to them all.<br>We have just held the first plenary session of the 19th central committee and elected a new central leadership. I was re-elected general secretary of the CPC central committee. I see this as not just approval of my work, but also encouragement that will spur me on.<br>Now I wish to present to you the other six members who have also been elected to the standing committee of the political bureau.<br>Comrade Li Keqiang, Comrade Li Zhanshu, Comrade Wang Yang, Comrade Wang Huning, Comrade Zhao Leji, Comrade Han Zheng.<br>Comrade Li Keqiang served on the political Bureau’ standing committee of the 18th CPC central committee. While all the others were the member of the political Bureau of the 18th CPC central committee. You can learn more about them from the media.<br>Here, on behalf of the newly elected central leadership, I wish to express our heartfelt thanks to all other members of the party, for the trust they have placed in us. We will work diligently to meet our duty, fulfill our mission and be worthy of their trust.<br>Over the past five years, we have set out a broad agenda. Some tasks have been completed, while others need more work. This party congress has set new goals and new tasks. We must make coordinated efforts to see them through.<br>With decades of hard work, socialism with Chinese characteristics has entered a new era. In this new contest, we must get a new look, and more importantly make new accomplishments. The coming five years, between the 19th and 20th party congress, is a period in which the time frames of the two centenary goals will converge. Not only must we deliver the first centenary goal, we must also embark on the journey towards the second centenary goal. As I look ahead to the next five years, I see several important junctures and sign posts.<br>In 2018, we will mark the 40th anniversary of the launch of the reform and opening-up. Reform and opening-up is a crucial move that is shaping China’s future. 40 years of reform and opening-up has made it possible for our people to lead decent and even comfortable lives. We will review our experience and build on the good momentum to continue modernizing China’s system and capacity for governance, and make determined efforts to comprehensively deepen reform and open China still wider to the world. We will see that reform and opening-up complement and reinforce each other. It is my conviction that the great rejuvenation of the Chinese nation will become a reality in the course of reform and opening-up.<br>In 2019, we will mark the 70th anniversary of the founding of the People’s Republic of China. We will act on the new vision for development and strive a sustained and healthy economic growth that benefits people in China and around the world. We will continue our efforts to accomplish all the tasks left down in the 13th five-year-plan, develop new blueprints for China’s future and see the flourishing of all our endeavors. These efforts will contribute towards a more prosperous and strong People’s Republic.<br>In 2020, we will establish a moderately prosperous society across all metrics.  This is a society to be enjoyed by each and every one of us. On the march towards common prosperity, no one must be left behind. We will mobilize the whole party and whole country in the resolute push to deliver on our pledge and eradicate poverty in China. The aspersions of the people to live a better life must always be the focus of our efforts. We must remain committed to people-centered philosophy of development, strive to ensure and improve living standards, and make steady progress towards enhancing our people’s sense of fulfilment, happiness and security and towards realizing common prosperity for everyone. I have no doubt in my mind that our people’s lives will see further improvement year after year.<br>In 2021, we will mark the centenary of the Communist Party of China. For the party which fights for the eternal well-being of the Chinese nation, the centenary only ushers in the prime of life. As the world’s largest political party, the CPC must behave in a way commensurate with this status. Its history makes it abundantly clear that the CPC is capable of not only spearheading a great social revolution, but also imposing a great reform on itself. We, as its members, must always have a youthful spirit and forever be the servants of the people, the vanguard of the times and the backbone of our nation. Exercising full and rigorous governance over the party is a journey to which there is no end. We should never entertain the idea of taking a breather or halting our steps. Instead we must continue to rid ourselves of any virus that erodes the party’s fabric, make great effort to foster a healthy political environment of integrity and generate waves of positive energy throughout our party, which can then building into a mighty, nation-wide force, driving China’s development and progress.<br>The Communist Party of China and Chinese people have gone through trials and tribulations. These experiences have taught us that peace is precious and development must be valued. With confidence and pride, the Chinese people will be steadfast in upholding our country’s sovereignty, security and development interests. We will also work with other nations to build a global community with a shared future and make new and greater contributions to the noble course of peace and development for all humanity.<br>The people are the creators of history. It is to them that we own all our achievements. As long as we firmly align ourselves with our people and rely on them, we can and will have boundless energy to forge ahead, come rain or shine.<br>As the saying goes, it is better to see once than to hear a hundred times. We encourage members of the press to visit and see more of China. We hope that, after the party congress, you will continue to follow china’s development and progress, and learn about and report on more dimensions of China.<br>We do not need lavish praise from others; however, we do welcome objective reporting and constructive suggestions, for this is our motto, ‘not angling for complements, I’d be content let my integrity feels the universe.’<br>Thank you.</p>]]></content>
      
      <categories>
          
          <category> 日记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 随笔 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Tenda(腾达)W311R无线路由器开WISP</title>
      <link href="/2017/10/14/2017-10-14-tendawisp/"/>
      <url>/2017/10/14/2017-10-14-tendawisp/</url>
      <content type="html"><![CDATA[<p>首先祝贺获奖，反正你是最厉害的。<br>然后就是今天做的。（现在真的是做什么都没那么有激情了）<br>本来准备把原来的路由器和电信的光猫进行WDS桥接，但似乎是由于不同品牌，试了一整天都没有成功，期间改变各种变量，并重置了多次，最后只能重新买了一个路由器dlink dir859; 这款功率真的不错，开中级就能基本覆盖了。然后多了一台老路由TP-Link WR740N，拿到乡下与原来的路由Tenda W311R桥接，发现仍然不行。并多次改变了主从路由，即便可以ping通，电脑仍显示无法连接英特网（血与泪的教训，买路由器要买同一品牌）。由于电信网络电视的限制（专线)，因些尝试把一台当交换机用也不行，最后只能无奈刷固件。<br><a id="more"></a><br>比较了下两台路由器，并查了些资料后，发现W311R可以通过刷万能中继固件实现WISP,WISP比起WDS简直方便太多，可以兼容任何上级品牌的无线路由器信号。关于各种定义慢慢总结介绍，这几天记了好些笔记。<br>首先介绍W311R刷固件方法</p><ol><li><strong>刷固件前首先要确认W311R处理芯片的型号</strong><br>W311R有后面有两个螺丝在两个缓冲脚垫后，拧下后从后面向两侧撬开，两侧各有一个卡口，而前脸（灯两边下也有两个）的两个可能要用螺丝刀从里而捅戳一下，从外面很难弄开，因此一开始要幅度不要太大。<br>我是直接撬起了点看了下处理器型号（方形黑片），按网上的说法如果能看到5356那就是可刷的，如果5356后面是COKFBG成功率会高，而LKFBG和AIFBG成功率低，我的是LKFBG第一次刷成功变砖，正感叹并准备以后有空再买TTL线之时，天无绝人之路，发现可以挽回，喜欢折腾的可以试下</li><li><strong>下载固件包</strong><br>链接：<a href="http://pan.baidu.com/s/1gf09QUZ" target="_blank" rel="noopener">http://pan.baidu.com/s/1gf09QUZ</a> 密码：x6me</li><li><strong>首先刷.trx文件</strong><br>具体的办法就不多介绍了，就是登录管理界面，建议使用网线连lan口（四个黄色口)升级（我在后面升级发现无线连接传输失败的问题），然后把系统版本升级成v5.07.50cn(如果已经升级到了就不需要，在上传框下面会有小字显示)，上传升级后等待重启就可以了，重连接后可以按reset初始化一下，等待再次连接<br>PS：升级过程中不能断电，否则没救了</li><li><strong>然后刷.bin文件</strong><br>过程同上，刷完如果不能连接初始化一下，如果还不行，多半是变砖了（拔了电源重插后只有电源指示灯亮）我当时就是到了这一步。</li><li><strong>连主路由无线</strong><br>当然成功的同学就可以看到一个全新的控制界面，只要界面里找到无线网络，无线放大器扫描后输入密码就可以了。</li></ol><p>下面介绍的是变砖后的补救办法。<br>1.通过网线连接，然后把ip地址设置为192.168.0.2，运行windows控制台，ping 192.168.0.1即路由器的lan口，如果能通，说明有救；<br>2.在控制台下，输入appwiz.cpl，打开程序和功能 - 打开或关闭windows功能，勾选tftp客户端安装，<br>3.给路由器上电后，长按reset半分钟，然后拔掉电源<br>4.在cmd控制台中先输入tftp -i 192.168.1.1 put c:\tengda.trx(刚刚下载的trx文件路径)<br>5.接通电源同时控制台输入回车，显示传输成功就得救了，可以试试另找固件包再刷。</p>]]></content>
      
      <categories>
          
          <category> 技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 技术 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>2017.09.13</title>
      <link href="/2017/09/13/2017-09-13/"/>
      <url>/2017/09/13/2017-09-13/</url>
      <content type="html"><![CDATA[<p>9.13记<br><a id="more"></a><br>相信自己的选择<br>无论怎样<br>这是你与别人一直以来的区别<br>做不到的我是不会说的<br>但是无论怎样<br>你一定会是很特殊的</p><p>17号考托福，感觉这次复习得一塌糊涂，不过也没什么好说的，等弄完再考虑别的<br>很多事真的真的超级难的，我希望我是一直努力的，就这点希望还是好的吧<br>不过最后考虑了下，四年真的过得太平淡了，虽然一直的性格是这样，但也正是因为这样吧</p>]]></content>
      
      <categories>
          
          <category> 日记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 随笔 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>2017.09.03</title>
      <link href="/2017/09/03/2017-09-03/"/>
      <url>/2017/09/03/2017-09-03/</url>
      <content type="html"><![CDATA[<p>9.03记<br><a id="more"></a><br>像我这样的人，这么随心，不喜欢被束缚，<br>这么挑剔，这么喜欢稳定，这么理想化<br>如今又努力做什么呢<br>现在真的不知道该怎么办才好<br>我也蛮无奈啊<br>也许遇见只是个意外吧<br>真的是蛮意外的了<br>哪来什么以后，不以后<br>在看了好多集yes,minister之后<br>在经历了邻里纠纷之后<br>我深刻的知道了<br>Knowledge only means complicity and gulit<br>Ignorance has some dignity<br>和自已的无知<br>也简单的理解了，或许一生就是仅是这样吧<br>不应该抗争什么，特别是为了一点点感觉<br>想想真是又气又好笑<br>自己真是太胆小了</p>]]></content>
      
      <categories>
          
          <category> 日记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 随笔 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Git Commit的书写规范</title>
      <link href="/2017/07/24/2017-07-24-gitcommit/"/>
      <url>/2017/07/24/2017-07-24-gitcommit/</url>
      <content type="html"><![CDATA[<p>晚上搜资料发现原来git commit的message也有书写规范，学习下<br><a id="more"></a><br>比较常用的是Angular书写规范，如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;type&gt;(&lt;scope&gt;): &lt;subject&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;footer&gt;</span><br></pre></td></tr></table></figure></p><p>由于我现在所写的程序比较简单，所以比较重要的是type和subject<br>1）type分为以下七个：</p><ul><li><p>feat：新功能（feature）</p></li><li><p>fix：修补bug</p></li><li><p>docs：文档（documentation）</p></li><li><p>style： 格式（不影响代码运行的变动）</p></li><li><p>refactor：重构（即不是新增功能，也不是修改bug的代码变动）</p></li><li><p>test：增加测试</p></li><li><p>chore：构建过程或辅助工具的变动</p></li></ul><p>2）subject是commit目的简短描述</p><ul><li><p>以动词开头，使用第一人称现在时，比如change，而不是changed或changes</p></li><li><p>第一个字母小写</p></li><li><p>结尾不加句号（.）</p></li></ul><p>而scope是说明commit影响的范围<br>body是详细说明<br>footer则用于不兼容变动等情况时<br>以上三种等用到时再详加说明。</p>]]></content>
      
      <categories>
          
          <category> 学习笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> git </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>关于git常用命令的介绍</title>
      <link href="/2017/07/24/2017-07-04-git-command/"/>
      <url>/2017/07/24/2017-07-04-git-command/</url>
      <content type="html"><![CDATA[<p>刚刚开始学python的时候接触了git，虽然现在没有做大项目，但git的功能真的是太强大了，简单记录下常用的几个命令。<br><a id="more"></a></p><h1 id="初始化"><a href="#初始化" class="headerlink" title="初始化"></a>初始化</h1><p><code>git init</code><br>切换到相应文件夹后用此命令可以初始化一个git仓库</p><h1 id="检查状态"><a href="#检查状态" class="headerlink" title="检查状态"></a>检查状态</h1><p><code>git status</code><br>用于检测仓库中有哪些文件初修改了，增加或删除了哪些文件等</p><h1 id="将文件加入仓库"><a href="#将文件加入仓库" class="headerlink" title="将文件加入仓库"></a>将文件加入仓库</h1><p><code>git add filename.xxx</code><br>用于添加文件<br>另外还有几个更方便的命令<br><code>git add -A</code><br>提交文件夹下所有文件改动到暂存区<br><code>git add .</code><br>提交工作区变化到暂存区，包括新文件但不包括被删除文件<br><code>git add -u</code><br>提交被add文件改动到暂存区，不包括新文件，但包括被删除文件</p><h1 id="执行提交"><a href="#执行提交" class="headerlink" title="执行提交"></a>执行提交</h1><p><code>git commit -m &quot;message&quot;</code><br>提交修改，message中可以加入些改动说明</p><h1 id="重命名文件"><a href="#重命名文件" class="headerlink" title="重命名文件"></a>重命名文件</h1><p><code>git mv oldfilename.xx newfilename.xx</code></p>]]></content>
      
      <categories>
          
          <category> 备忘 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> git </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Sublime3中调用cmd终端</title>
      <link href="/2017/07/23/2017-07-23-pythonterminal/"/>
      <url>/2017/07/23/2017-07-23-pythonterminal/</url>
      <content type="html"><![CDATA[<p>最近在学习python，由于sublime的控制台不能支持输入，经常是一边敲代码一边复制到cmd终端，偶然发现可以配置sublime中的termianl插件支持直接调用终端，具体方法如下：<br><a id="more"></a></p><h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><p>直接在sublime中输入<code>ctrl+shift+p</code>，然后输入<code>install package</code>或<code>pcip</code>进入安装插件列表，然后输入<code>terminal</code>安装插件</p><h1 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h1><p>安装完成后，在sublime中打开<code>Preferences - Package Settings - Termial - Settings User</code>，然后在窗口中根据自己的终端路径输入如下代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123; </span><br><span class="line">// window下终端路径 </span><br><span class="line">&quot;terminal&quot;: &quot;C:\\Windows\\System32\\cmd.exe&quot;, </span><br><span class="line">// window下终端参数 </span><br><span class="line">&quot;parameters&quot;: [&quot;/START&quot;, &quot;%CWD%&quot;] </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>如果是Linux系统则为<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;terminal&quot;: &quot;xterm&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>OS X:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;terminal&quot;: &quot;iTerm.sh&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>由于本人系统是windows所以其他两种并未尝试，可自行试验。</p><h1 id="运行"><a href="#运行" class="headerlink" title="运行"></a>运行</h1><p><code>ctrl+shif+T</code>就可以运行弹出终端了</p>]]></content>
      
      <categories>
          
          <category> 学习笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> sublime </tag>
            
            <tag> cmd </tag>
            
            <tag> terminal </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Markdown语法说明</title>
      <link href="/2017/07/19/2017-07-19-markdown/"/>
      <url>/2017/07/19/2017-07-19-markdown/</url>
      <content type="html"><![CDATA[<p>由于刚接触markdown，因此通过本文记录markdown语法，防止经常不必要的检索<br><a id="more"></a></p><h1 id="基本语法"><a href="#基本语法" class="headerlink" title="基本语法"></a>基本语法</h1><h2 id="无序列表"><a href="#无序列表" class="headerlink" title="无序列表"></a>无序列表</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* test</span><br><span class="line">+ test2</span><br><span class="line">- test3</span><br></pre></td></tr></table></figure><ul><li>test2</li></ul><ul><li>test3</li></ul><ul><li>test4</li></ul><h2 id="有序列表"><a href="#有序列表" class="headerlink" title="有序列表"></a>有序列表</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1. test</span><br><span class="line">2. test</span><br></pre></td></tr></table></figure><ol><li>test</li><li>test</li></ol><h2 id="分割线"><a href="#分割线" class="headerlink" title="分割线"></a>分割线</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">***</span><br></pre></td></tr></table></figure><p>下面是分割线：</p><hr><h1 id="博文的截取"><a href="#博文的截取" class="headerlink" title="博文的截取"></a>博文的截取</h1><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- more --&gt;</span></span><br></pre></td></tr></table></figure><p>在需要截断的地方添加这个标签，可以精准截断；</p><h1 id="表格"><a href="#表格" class="headerlink" title="表格"></a>表格</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">标题1| 标题2 | 标题3</span><br><span class="line">-----| ----- | -----</span><br><span class="line">行1列1| 行1列2| 行1列3</span><br></pre></td></tr></table></figure><table><thead><tr><th>标题1</th><th>标题2</th><th>标题3</th></tr></thead><tbody><tr><td>行1列1</td><td>行1列2</td><td>行1列3</td></tr></tbody></table><h1 id="删除线"><a href="#删除线" class="headerlink" title="删除线"></a>删除线</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~~删除~~</span><br></pre></td></tr></table></figure><p><del>删除</del></p><h1 id="字体、字号、颜色的更改"><a href="#字体、字号、颜色的更改" class="headerlink" title="字体、字号、颜色的更改"></a>字体、字号、颜色的更改</h1><p>在markdown中更改字体大小及颜色可以使用html语法<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">font</span> <span class="attr">size</span>=<span class="string">4</span> &gt;</span> 自定义字体大小 <span class="tag">&lt;/<span class="name">font</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">font</span> <span class="attr">color</span>=<span class="string">"#FF0000"</span>&gt;</span> 自定义字体颜色 <span class="tag">&lt;/<span class="name">font</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">font</span> <span class="attr">color</span>=<span class="string">"blue"</span>&gt;</span> 自定义字体颜色 <span class="tag">&lt;/<span class="name">font</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>效果如下:</p><font size="4"> 自定义字体大小 </font><br><font color="#FF0000"> 自定义字体颜色 </font><br><font color="blue"> 自定义字体颜色 </font>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;small&gt;&lt;small&gt;最小字号&lt;/small&gt;&lt;/small&gt;</span><br><span class="line">&lt;small&gt;小字号&lt;/small&gt;</span><br><span class="line">&lt;big&gt;大字号&lt;/big&gt;</span><br><span class="line">&lt;big&gt;&lt;big&gt;大大字号&lt;/big&gt;&lt;/big&gt;</span><br><span class="line">&lt;big&gt;&lt;big&gt;&lt;big&gt;大大大字号&lt;/big&gt;&lt;/big&gt;&lt;/big&gt;</span><br><span class="line">&lt;big&gt;&lt;big&gt;&lt;big&gt;&lt;big&gt;继续加可以继续大下去&lt;/big&gt;&lt;/big&gt;&lt;/big&gt;&lt;/big&gt;</span><br></pre></td></tr></table></figure><p><small><small>最小字号</small></small><br><small>小字号</small></p><big>大字号</big><br><big><big>大大字号</big></big><br><big><big><big>大大大字号</big></big></big><br><big><big><big><big>继续加可以继续大下去</big></big></big></big><p>而字体的设置详见<a href="http://theme-next.iissnan.com/theme-settings.html#fonts-customization" target="_blank" rel="noopener">NexT使用文档</a>;</p>]]></content>
      
      <categories>
          
          <category> 备忘 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> markdown </tag>
            
            <tag> 语法 </tag>
            
            <tag> 备忘 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>布署Nginx和Gunicorn时遇到的问题</title>
      <link href="/2017/07/19/2017-07-19-nginxgunicorn/"/>
      <url>/2017/07/19/2017-07-19-nginxgunicorn/</url>
      <content type="html"><![CDATA[<p>写这篇文章是自己在做个人博客时的一些经验，在这几天的选择中，先后用了Python+Django，wordpress和hexo，最后决定暂时先用hexo应付，最终争取用python+Django自己完成博客的搭建。<br>一开始做博客参考的是<a href="http://zmrenwu.com/category/django-blog-tutorial/" target="_blank" rel="noopener">追梦人物</a>的博客教程，在做到发布前可以说介绍的非常详细，我按照教程也基本都做出来了，但到了发布则相当的简略，涉及到诸多问题。为些记录下我的发布历程，方便以后再次发布。<br><a id="more"></a><br>一直到启动<strong>Nginx服务</strong>这里都可以按照他博客介绍的做，但由于nginx中有默认配置，所以很多人会看到欢迎页面而不是<br><img src="https://github.com/qy19941014/blogimage/raw/master/img/WelcomeNginx.png" alt="WelcomeNginx"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(env) yangxg@localhost:~/sites/demo.zmrenwu.com/django-blog-tutorial$ python manage.py makemigrate</span><br><span class="line">(env) yangxg@localhost:~/sites/demo.zmrenwu.com/django-blog-tutorial$ python manage.py migrate</span><br></pre></td></tr></table></figure></p><p>如果看到欢迎页面是DefaultPages，仍可以继续往下做<br>接着就按照<strong>部署代码</strong>中的步骤完成代码<strong>部署前的项目配置、在github的上传</strong>等，其中生成数据库时我提示错误，然后按照提示内容操作了下<br>具体是<br>直到<strong>配置Nginx</strong>，<br>配置Nginx的具体方法是：<br>（因为第一次没成功，我没有在虚拟环境中进行，此文仅还原我的操作过程）<br>首先在Xshell中输入<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yangxg@localhost:~/sites/demo.zmrenwu.com/django-blog-tutorial$ cd</span><br></pre></td></tr></table></figure></p><p>退出到根目录<br>然后<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yangxg@localhost:$ cd /etc/nginx/sites-available/</span><br><span class="line">yangxg@localhost:/etc/nginx/sites-available/$  sudo vi default</span><br></pre></td></tr></table></figure></p><p>如果提示输入密码就输入之前设置的密码，然后就可以直接按照教程修改default文件中的配置内容（如果要新建文件夹并新建配置文件也可以，但应该要删除default文件）<br>删除命令是<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yangxg@localhost:/etc/nginx/sites-available/$  sudo rm default</span><br></pre></td></tr></table></figure></p><p>配置修改完成后按<strong>Esc</strong>，然后输入<strong>:wq</strong>进行保存，然后我重新进入按之前的步骤进入虚拟虚拟<br>然后发送配置文件到sites-enabled/目录<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yangxg@localhost:~/sites/demo.zmrenwu.com/django-blog-tutorial$ sudo ln -s /etc/nginx/sites-available/demo.zmrenwu.com /etc/nginx/sites-enabled/demo.zmrenwu.com</span><br></pre></td></tr></table></figure></p>]]></content>
      
      <categories>
          
          <category> 博客搭建 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 技术 </tag>
            
            <tag> 博客 </tag>
            
            <tag> Nginx </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>2017.7.18</title>
      <link href="/2017/07/18/2017-7-18/"/>
      <url>/2017/07/18/2017-7-18/</url>
      <content type="html"><![CDATA[<h2 id="最近做的事"><a href="#最近做的事" class="headerlink" title="最近做的事"></a>最近做的事</h2><p>7月13号考完后有点浪，学习得很盲目，但这几天终于睡得不错了。<br>这几天主要是在构想自己的博客，初步计划是用Python+Django做，已经按教程做完并布署了，但由于细节太麻烦，但又不想轻易放弃因此考虑在本地研究，并通过markdown记录。为了好发布，因此也考虑用其他先暂时充数，首先考虑的是wordpress，还是喜欢动态博客而且正好有多的服务器，但弄完发现有点不太适合我。一是没有markdown，二是主题要好看也要订制，比较麻烦，因此我考虑使用hexo。hexo+github是比较轻量化的博客，静态，但布署简单，做好很难，现在用的是别人做的模版，做这个确实不会，所以只能参考了。今天大致弄完了，以后就可以安心发文章并且研究别的了。<br>最近是真的不想想别的事了，很难过。</p>]]></content>
      
      <categories>
          
          <category> 日记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 随笔 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>89C51与AD0832波形输出</title>
      <link href="/2017/07/18/2017-07-18-waveoutput/"/>
      <url>/2017/07/18/2017-07-18-waveoutput/</url>
      <content type="html"><![CDATA[<p>原文是来自我的CSDN博客，用于迁移测试，练习Markdown</p><p>本次实验通过proteus仿真<br>仿真电气连接图：<br><img src="https://github.com/qy19941014/blogimage/raw/master/img/2017.7.18.1.jpg" alt="electricconnection"><br><a id="more"></a><br>本次实验通过keil编译通过，实验程序如下：<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;absacc.h&gt;  </span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;reg52.h&gt;  </span></span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DA0832 XBYTE[0xfffe]  </span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> uchar unsigned char  </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> uint unsigned int  </span></span><br><span class="line"></span><br><span class="line">sbit S1 = P1^<span class="number">0</span>;  </span><br><span class="line">sbit S2 = P1^<span class="number">1</span>;  </span><br><span class="line"><span class="comment">//00锯齿波；01方波；10三角波；11正弦波  </span></span><br><span class="line"></span><br><span class="line"> uchar code sin_tab[] =        <span class="comment">//正弦波输出表  </span></span><br><span class="line">&#123;  </span><br><span class="line">    <span class="number">0x80</span>,<span class="number">0x83</span>,<span class="number">0x86</span>,<span class="number">0x89</span>,<span class="number">0x8D</span>,<span class="number">0x90</span>,<span class="number">0x93</span>,<span class="number">0x96</span>,<span class="number">0x99</span>,<span class="number">0x9C</span>,<span class="number">0x9F</span>,<span class="number">0xA2</span>,<span class="number">0xA5</span>,<span class="number">0xA8</span>,<span class="number">0xAB</span>,<span class="number">0xAE</span>,  </span><br><span class="line">    <span class="number">0xB1</span>,<span class="number">0xB4</span>,<span class="number">0xB7</span>,<span class="number">0xBA</span>,<span class="number">0xBC</span>,<span class="number">0xBF</span>,<span class="number">0xC2</span>,<span class="number">0xC5</span>,<span class="number">0xC7</span>,<span class="number">0xCA</span>,<span class="number">0xCC</span>,<span class="number">0xCF</span>,<span class="number">0xD1</span>,<span class="number">0xD4</span>,<span class="number">0xD6</span>,<span class="number">0xD8</span>,  </span><br><span class="line">    <span class="number">0xDA</span>,<span class="number">0xDD</span>,<span class="number">0xDF</span>,<span class="number">0xE1</span>,<span class="number">0xE3</span>,<span class="number">0xE5</span>,<span class="number">0xE7</span>,<span class="number">0xE9</span>,<span class="number">0xEA</span>,<span class="number">0xEC</span>,<span class="number">0xEE</span>,<span class="number">0xEF</span>,<span class="number">0xF1</span>,<span class="number">0xF2</span>,<span class="number">0xF4</span>,<span class="number">0xF5</span>,  </span><br><span class="line">    <span class="number">0xF6</span>,<span class="number">0xF7</span>,<span class="number">0xF8</span>,<span class="number">0xF9</span>,<span class="number">0xFA</span>,<span class="number">0xFB</span>,<span class="number">0xFC</span>,<span class="number">0xFD</span>,<span class="number">0xFD</span>,<span class="number">0xFE</span>,<span class="number">0xFF</span>,<span class="number">0xFF</span>,<span class="number">0xFF</span>,<span class="number">0xFF</span>,<span class="number">0xFF</span>,<span class="number">0xFF</span>,  </span><br><span class="line">    <span class="number">0xFF</span>,<span class="number">0xFF</span>,<span class="number">0xFF</span>,<span class="number">0xFF</span>,<span class="number">0xFF</span>,<span class="number">0xFF</span>,<span class="number">0xFE</span>,<span class="number">0xFD</span>,<span class="number">0xFD</span>,<span class="number">0xFC</span>,<span class="number">0xFB</span>,<span class="number">0xFA</span>,<span class="number">0xF9</span>,<span class="number">0xF8</span>,<span class="number">0xF7</span>,<span class="number">0xF6</span>,  </span><br><span class="line">    <span class="number">0xF5</span>,<span class="number">0xF4</span>,<span class="number">0xF2</span>,<span class="number">0xF1</span>,<span class="number">0xEF</span>,<span class="number">0xEE</span>,<span class="number">0xEC</span>,<span class="number">0xEA</span>,<span class="number">0xE9</span>,<span class="number">0xE7</span>,<span class="number">0xE5</span>,<span class="number">0xE3</span>,<span class="number">0xE1</span>,<span class="number">0xDF</span>,<span class="number">0xDD</span>,<span class="number">0xDA</span>,  </span><br><span class="line">    <span class="number">0xD8</span>,<span class="number">0xD6</span>,<span class="number">0xD4</span>,<span class="number">0xD1</span>,<span class="number">0xCF</span>,<span class="number">0xCC</span>,<span class="number">0xCA</span>,<span class="number">0xC7</span>,<span class="number">0xC5</span>,<span class="number">0xC2</span>,<span class="number">0xBF</span>,<span class="number">0xBC</span>,<span class="number">0xBA</span>,<span class="number">0xB7</span>,<span class="number">0xB4</span>,<span class="number">0xB1</span>,  </span><br><span class="line">    <span class="number">0xAE</span>,<span class="number">0xAB</span>,<span class="number">0xA8</span>,<span class="number">0xA5</span>,<span class="number">0xA2</span>,<span class="number">0x9F</span>,<span class="number">0x9C</span>,<span class="number">0x99</span>,<span class="number">0x96</span>,<span class="number">0x93</span>,<span class="number">0x90</span>,<span class="number">0x8D</span>,<span class="number">0x89</span>,<span class="number">0x86</span>,<span class="number">0x83</span>,<span class="number">0x80</span>,  </span><br><span class="line">    <span class="number">0x80</span>,<span class="number">0x7C</span>,<span class="number">0x79</span>,<span class="number">0x76</span>,<span class="number">0x72</span>,<span class="number">0x6F</span>,<span class="number">0x6C</span>,<span class="number">0x69</span>,<span class="number">0x66</span>,<span class="number">0x63</span>,<span class="number">0x60</span>,<span class="number">0x5D</span>,<span class="number">0x5A</span>,<span class="number">0x57</span>,<span class="number">0x55</span>,<span class="number">0x51</span>,  </span><br><span class="line">    <span class="number">0x4E</span>,<span class="number">0x4C</span>,<span class="number">0x48</span>,<span class="number">0x45</span>,<span class="number">0x43</span>,<span class="number">0x40</span>,<span class="number">0x3D</span>,<span class="number">0x3A</span>,<span class="number">0x38</span>,<span class="number">0x35</span>,<span class="number">0x33</span>,<span class="number">0x30</span>,<span class="number">0x2E</span>,<span class="number">0x2B</span>,<span class="number">0x29</span>,<span class="number">0x27</span>,  </span><br><span class="line">    <span class="number">0x25</span>,<span class="number">0x22</span>,<span class="number">0x20</span>,<span class="number">0x1E</span>,<span class="number">0x1C</span>,<span class="number">0x1A</span>,<span class="number">0x18</span>,<span class="number">0x16</span>,<span class="number">0x15</span>,<span class="number">0x13</span>,<span class="number">0x11</span>,<span class="number">0x10</span>,<span class="number">0x0E</span>,<span class="number">0x0D</span>,<span class="number">0x0B</span>,<span class="number">0x0A</span>,  </span><br><span class="line">    <span class="number">0x09</span>,<span class="number">0x08</span>,<span class="number">0x07</span>,<span class="number">0x06</span>,<span class="number">0x05</span>,<span class="number">0x04</span>,<span class="number">0x03</span>,<span class="number">0x02</span>,<span class="number">0x02</span>,<span class="number">0x01</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,  </span><br><span class="line">    <span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x01</span>,<span class="number">0x02</span>,<span class="number">0x02</span>,<span class="number">0x03</span>,<span class="number">0x04</span>,<span class="number">0x05</span>,<span class="number">0x06</span>,<span class="number">0x07</span>,<span class="number">0x08</span>,<span class="number">0x09</span>,  </span><br><span class="line">    <span class="number">0x0A</span>,<span class="number">0x0B</span>,<span class="number">0x0D</span>,<span class="number">0x0E</span>,<span class="number">0x10</span>,<span class="number">0x11</span>,<span class="number">0x13</span>,<span class="number">0x15</span>,<span class="number">0x16</span>,<span class="number">0x18</span>,<span class="number">0x1A</span>,<span class="number">0x1C</span>,<span class="number">0x1E</span>,<span class="number">0x20</span>,<span class="number">0x22</span>,<span class="number">0x25</span>,  </span><br><span class="line">    <span class="number">0x27</span>,<span class="number">0x29</span>,<span class="number">0x2B</span>,<span class="number">0x2E</span>,<span class="number">0x30</span>,<span class="number">0x33</span>,<span class="number">0x35</span>,<span class="number">0x38</span>,<span class="number">0x3A</span>,<span class="number">0x3D</span>,<span class="number">0x40</span>,<span class="number">0x43</span>,<span class="number">0x45</span>,<span class="number">0x48</span>,<span class="number">0x4C</span>,<span class="number">0x4E</span>,  </span><br><span class="line">    <span class="number">0x51</span>,<span class="number">0x55</span>,<span class="number">0x57</span>,<span class="number">0x5A</span>,<span class="number">0x5D</span>,<span class="number">0x60</span>,<span class="number">0x63</span>,<span class="number">0x66</span>,<span class="number">0x69</span>,<span class="number">0x6C</span>,<span class="number">0x6F</span>,<span class="number">0x72</span>,<span class="number">0x76</span>,<span class="number">0x79</span>,<span class="number">0x7C</span>,<span class="number">0x7E</span>  </span><br><span class="line">&#125;;  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Delay_MS</span><span class="params">(uint)</span></span>;<span class="comment">// delay   </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">stair</span><span class="params">(uchar AMP)</span></span>;<span class="comment">//锯齿波   </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">square</span><span class="params">(uchar AMP, uchar THL,uchar TLL)</span></span>;<span class="comment">//方波   </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">trian</span><span class="params">(uchar AMP)</span></span>;<span class="comment">//三角波   </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sin</span><span class="params">()</span></span>;<span class="comment">//正弦波   </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">scan</span><span class="params">()</span></span>;<span class="comment">//扫描函数   </span></span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">main</span><span class="params">()</span>  </span></span><br><span class="line"><span class="function"></span>&#123;     </span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="comment">//逐个测试   </span></span><br><span class="line">        <span class="comment">//stair(200);  </span></span><br><span class="line">        <span class="comment">//square(200,10,10);  </span></span><br><span class="line">        <span class="comment">//trian(200);  </span></span><br><span class="line">        <span class="comment">//sin();  </span></span><br><span class="line">        scan();  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">scan</span><span class="params">()</span>  </span></span><br><span class="line"><span class="function"></span>&#123;  </span><br><span class="line">    <span class="keyword">if</span>((<span class="number">0</span> == S1) &amp;&amp;(<span class="number">0</span> == S2))  </span><br><span class="line">        stair(<span class="number">200</span>);  </span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>((<span class="number">1</span> == S1) &amp;&amp; (<span class="number">0</span> == S2))  </span><br><span class="line">        square(<span class="number">200</span>,<span class="number">10</span>,<span class="number">10</span>);  </span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>((<span class="number">0</span> == S1) &amp;&amp; (<span class="number">1</span> == S2))  </span><br><span class="line">        trian(<span class="number">200</span>);  </span><br><span class="line">    <span class="keyword">else</span>  </span><br><span class="line">        <span class="built_in">sin</span>();  </span><br><span class="line">          </span><br><span class="line">          </span><br><span class="line">      </span><br><span class="line">&#125;  </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Delay_MS</span><span class="params">(uint n)</span>  </span></span><br><span class="line"><span class="function"></span>&#123;  </span><br><span class="line">    uint k;  </span><br><span class="line">    <span class="keyword">for</span>(n; n  &gt;<span class="number">0</span> ;n--)  </span><br><span class="line">        <span class="keyword">for</span>(k = <span class="number">10</span>; k &gt; <span class="number">0</span> ;k--);  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">stair</span><span class="params">(uchar AMP)</span>  </span></span><br><span class="line"><span class="function"></span>&#123;  </span><br><span class="line">    uchar i;  </span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span> ;i &lt; <span class="number">255</span>; i++)  </span><br><span class="line">    &#123;  </span><br><span class="line">        DA0832 = i;  </span><br><span class="line">    &#125;  </span><br><span class="line">       </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">square</span><span class="params">(uchar AMP, uchar THL, uchar TLL)</span>  </span></span><br><span class="line"><span class="function"></span>&#123;  </span><br><span class="line">    DA0832 = <span class="number">255</span> - AMP;  </span><br><span class="line">    Delay_MS(THL);  </span><br><span class="line">    DA0832 = <span class="number">255</span>;  </span><br><span class="line">    Delay_MS(TLL);  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">trian</span><span class="params">(uchar AMP)</span>  </span></span><br><span class="line"><span class="function"></span>&#123;  </span><br><span class="line">    uchar i;  </span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">255</span> - AMP ;i &lt; <span class="number">255</span>; i++)  </span><br><span class="line">    &#123;  </span><br><span class="line">        DA0832 = i;  </span><br><span class="line">    &#125;  </span><br><span class="line">      </span><br><span class="line">    <span class="keyword">for</span>(i<span class="number">-1</span> ;i &gt; <span class="number">255</span> - AMP; i--)  </span><br><span class="line">    &#123;  </span><br><span class="line">        DA0832 = i;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sin</span><span class="params">()</span>  </span></span><br><span class="line"><span class="function"></span>&#123;  </span><br><span class="line">    uchar i;  </span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">255</span>; i++)  </span><br><span class="line">    &#123;  </span><br><span class="line">        DA0832 = sin_tab[i];  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>其仿真输出如图所示：<br>正弦波:<br><img src="https://github.com/qy19941014/blogimage/raw/master/img/2017.7.18.2.jpg" alt="sinwave"><br>三角波:<br><img src="https://github.com/qy19941014/blogimage/raw/master/img/2017.7.18.3.jpg" alt="tranwave"><br>方波：<br><img src="https://github.com/qy19941014/blogimage/raw/master/img/2017.7.18.4.jpg" alt="squrewave"><br>锯齿波：<br><img src="https://github.com/qy19941014/blogimage/raw/master/img/2017.7.18.5.jpg" alt="sawtwave"></p>]]></content>
      
      <categories>
          
          <category> 单片机 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 技术 </tag>
            
            <tag> 单片机 </tag>
            
            <tag> 电子 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>2017.5.20</title>
      <link href="/2017/05/20/2017-5-20/"/>
      <url>/2017/05/20/2017-5-20/</url>
      <content type="html"><![CDATA[<h1 id="最近的若干想法"><a href="#最近的若干想法" class="headerlink" title="最近的若干想法"></a>最近的若干想法</h1><h2 id="王小波"><a href="#王小波" class="headerlink" title="王小波"></a>王小波</h2><p>&emsp;&emsp;最近看了<em>沉默的大多数</em>，本来应该是高中看的吧，或者更早，我却现在还在以龟速看。里面绝大多数的差点我都非法认同，放到今天也是非常适用的。今天看到的性教育及美国在一战二战时候的审查之严格和今日的中国也差不多，这方面我其实是想认同需要审查的。现在很多人宣称的自由化我并不是都认同的，但不反对是我能给的最大的支持了，任何事为了政治正确去宣扬，去加速进程，都会损害另一方的利益（虽然他们可能是目前的受益者），但每个人都有自己选择的权利，在时机没成熟之前推行，我宁愿保守。审查我觉得只是尺度的问题。就像中国建国之初的党内民主讨论会，确实是下级敢冒犯上级吧，大家都畅所欲言，现在就成了一言堂了，说到底还是知识水平不够，而现在说中国不民主，其实也是整体水平不行，而上面似乎也乐见其成。<br><a id="more"></a></p><h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><p>&emsp;&emsp;真希望很多事都简单到有默契就好了。<br>&emsp;&emsp;王国维在<em>人间词话</em>中有说：</p><blockquote><p>古今之成大事业、大学问者,必经过三种之境界：<br>第一种境界是“昨夜西风凋碧树,独上西楼,望尽天涯路”——宋·晏殊·《鹊踏枝》<br>第二种境界是“为伊消得人憔悴,衣带渐宽终不悔” —— 宋·柳咏·《蝶恋花》<br>第三种境界是“众里寻他千百度,蓦然回首,那人却在灯火阑珊处” ——宋·辛弃疾·《青玉案》</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">life <span class="keyword">is</span> short</span><br><span class="line">life <span class="keyword">is</span> sigle</span><br></pre></td></tr></table></figure>]]></content>
      
      <categories>
          
          <category> 日记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 随笔 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>2017年计划</title>
      <link href="/2016/12/31/2016-12-31-plan/"/>
      <url>/2016/12/31/2016-12-31-plan/</url>
      <content type="html"><![CDATA[<p>依然还是先流水帐&gt;.&lt;</p><ol><li>今年拿到了驾照，真心不容易，然后当晚就开了一段，后来还开了两次无锡，但开车还是要更多的练习，专注。</li><li>2月听说萌妹纸的四六级，她居然和我说什么越刷越低，她那么霸气侧漏的人怎么可以那样，所以成功刷的比她高，哈哈开心，她酷的时候真的很可爱。</li><li>2-3月全面改了五笔，真心不容易，此处应该感谢美美，多亏陪我聊天让我成功过渡。</li><li>看完了三体1，a walk to remember,冰火1，目送，失乐园，one day，蒋勋讲宋词等书，还不够，年末买了ku，明年要多看点。<a id="more"></a></li><li>上半年还看了很多p图技巧，弄出了许多自己比较满意的照片，但还差很远，还要努力学习。</li><li>没字幕看了冰火和eevblog真心不容易，但还是要坚持，对自己提高还是挺多的。</li><li>总是能在各种巧合的时候碰到萌妹纸，真的挺不容易，但还是没做到去年末的愿望要和她混熟，因为真的感觉和她三观很一致，难得碰到，也是真心喜欢，但是我还是坚持当时和女神说的那些，不应该做的坚决不做，遇到就是幸福了。每次真的特别巧，而且总是能一眼认出来。可惜没约成功= =好想问她好多好多问题。</li><li>暑假时候解决了遗憾，挺不容易。</li><li>今年在假期和爸妈出去了两次，难得陪他们出去，以后也不知道会怎样但有机会还是要一起出去玩，开心。还一起跑步，身体也渐好。</li><li>下半年基本没做什么，课也没去上，然后也没怎么出去玩，中间出去吃的一顿是和丽洁，认识很不容易，她还给我带了马来西亚的咖啡和咖喱，希望以后还能碰见她，要加油来中国哦~</li><li>考研其实不是特别顺利，总是这样，平时很厉害的样子但到关键时刻就掉链子，其实还是比较水，但感谢小伙伴们一起努力学习让我有动力，嗯感谢萌妹纸开导我（一定是的~。也很感谢她，真的，一直是我的动力，但这样总是感觉有时候动力不足。很想约她一起说说话。。。唉= =可是都好久没有看见了。</li><li>16年没有去远的地方玩，这可能是除了和萌妹纸混熟之外唯一没完成的愿望了。。。好想有空去日本自由行。<br>其他还有很多未尽的事都记在微信了。。去年说要少玩手机其实应该可以算是做到了，很少找人聊天了，除了有限的几个人说说，其他很少主动说。。。然后朋友圈一直发是因为把它当日记了。。挺不错的。</li></ol><hr><p>16年应该依旧很平凡，关于17年，写计划这事其实是去年才真的开始的，都是些不起眼的小事，但却无意做成了挺多，明年还要努力，但还是想先写点小事希望都可以都完成。至于更多的还是要看考没考上研，应该会有所不同。<br>最想完成的几件事</p><ol><li>练字，考核结果是楷书能写的基本可以看。</li><li>python或者是个人blog希望能学习并完成一个</li><li>去比较远的地方玩</li><li>如果有可能，还要和萌妹纸混熟一点，感觉她很不一样，总是能一下看出来，但后来就不太准了- -，毕业了就很难看到了，但希望以后还有机会。</li><li>要为自己找好出路并努力，以后还是想走纯工科的技术路线，但可能会比较难，希望自己可以努力做到</li><li>minecraft建设大业向前推进一大步~</li><li>开通了ku希望明年一个月可以看掉至少一本文学类书。依然要坚持看剧和eevblog，习惯没有字幕。<br>专业书的话要看考研结果= =</li><li>其他应该要等结果出来再定了。留个坑。<br>希望自己可以慢慢的改变，很多时候，我习惯不是特别好，容易惹别人生气，并没有太多别的原因，不会说话吧，但毫无恶意，只是希望很多时候能够相互坦诚，也希望大度，大方，无私的人可以活得更幸福，这会是个自私的社会，一直也都是，而且生活所迫很多人都会改变，但还是希望能多点理解，多点关心吧，总是套路得人心毕竟不是我喜欢的。应该也是极其厌恶的。个人的努力并不会有结果，而且会成为异类。2016国际国内都不容易，希望2017可以更好。中华民族伟大复兴的中国梦，加油，中国的少年们加油~</li></ol>]]></content>
      
      <categories>
          
          <category> 计划 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 计划 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>2016年计划</title>
      <link href="/2015/12/31/2015-12-31-plan/"/>
      <url>/2015/12/31/2015-12-31-plan/</url>
      <content type="html"><![CDATA[<p>2015年，相对于以往充实了很多，但是真的是习惯了懒惰就很难再勤劳起来。看了14年写的15年要干的真的是好幼稚，过去不堪回首。先讲一下对于15年自己看不惯自己的。<br><a id="more"></a></p><ol><li>手机仍然使用太频繁，但没有干多少有意义的事，社交网络使用过于频繁。</li><li>生活规律间歇性失常。</li><li>经常想一些不该想的事情，导致做事的时候发呆不专注</li><li>该改的习惯一个没改，还是那么说的比做的多，还是说话，做事不经大脑</li><li>字没好好练，名字写出来还是那么烂</li><li>c++还是没看完，专业书看的很慢，倒是买书的速度远远比看书的速度快，堆积无数。</li><li>图书馆借的书，有的书反复借了多次都没有看过一次</li><li>花钱还是太随性，导致额外支出太多</li><li>上课还是会开小差，上课效率极差，以至于上课时间浪费，下课还不及时补</li><li>布置的任务总是不能按时完成。</li></ol><p>以上是15年的十宗罪，写的也许都有些宽泛，毕竟还是赶时间<br>下面谢谢自己在15年做的事</p><ol><li>电子设计干的还不错</li><li>下半年坚持了每天都看点单词</li><li>下半年每周能保证一本书，阅读量增加了不少，看完了三本鬼吹灯，七本明朝那些事，老人与海，dear john，a walk to remember，知乎周刊也看了很多，坚持使用pocket，当然看完了电子电气工程师必知必会也是不容易。</li><li>在北京生活了两周，知道了很多东西，了解了很多，生活真的还是要努力。</li><li>三级没过，过了四级</li><li>终于去了台湾，了解了不一样的风情，好想生活在那么美的城市。</li><li>认识了北大的女神，见着了Lizzie（现在都是泪），也看到了妹夫，平安夜还认识了Richia，真的好像和这个萌妹纸混熟了= =</li><li>和温温去看了周杰伦的演唱会，了却了人生的梦想。</li><li>星巴克半年变成了金星会员，刷遍星巴克有木有。</li><li>手机上放弃拼音输入，改成笔画</li></ol><p>想想真的也没做什么，微不足道，但是很多真的会让我不会再后悔。我做什么事都是好慢，好能拖，所以才不适合干好多事，总是需要人督促吧。都是泪啊，然而办法是有，但是还是更喜欢自由。</p><p>2016年是大学生活里最关键的一年了吧，读研是肯定的，年底就会考试，所以真正属于自己的时间并不多。<br>研究生应该是考的，真的好难。最终要的事情还是要减少手机的使用和多专注于正在做的事情，这样很多事情都能解决。<br>2016年，真的会是人生很关键的一年，15年下半年已经过的很茫然了，我想16年还会更茫然的。经过多日的思考我想2016年要我要完成下面的这些事。先列总的然后再把寒假要做的列上。</p><ol><li>减少手机的使用，做事情要专注，减少发朋友圈和看朋友圈的次数，尽量只在早上和晚上睡前什么看看。聊天也是要减少。都要在任务完成的情况下。</li><li>坚持看书，坚持看英文原著，坚持看专业书。</li><li>学会打五笔，删除拼音输入法</li><li>争取实现看剧可以只用英文字幕，减少对中文字幕的依赖</li><li>坚持有空就自习。</li><li>做好项目，完成梦想。</li><li>找到想去的学校，考研和出国，还是会选择考研吧，没底子真的很难啊。</li><li>去一个地方玩，远点的</li><li>看书</li><li>看书<br>多看书才能充实自己啊，其实自己的记忆力很强就是不专注，虽然有点晚了，但是想改变总是不晚的。努力看书吧。多学习。</li></ol>]]></content>
      
      <categories>
          
          <category> 计划 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 计划 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>使用分治法计算逆序数</title>
      <link href="/2014/10/25/2014-10-25-divideandconquer/"/>
      <url>/2014/10/25/2014-10-25-divideandconquer/</url>
      <content type="html"><![CDATA[<p>也许是第一次写这样的程序，略显生疏，希望通过以后学习能够有更多的进步，因为是在coursera上学算法，全英文课也着实坑爹了点，只能说继续努力吧！！相信自己。我看行！希望有大神可以多提意见，一定认真学习改进。<br><a id="more"></a><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*----------------------------------------------- </span></span><br><span class="line"><span class="comment">  名称：Use divide-and-couquer count the inversion 分治法计算逆序数  </span></span><br><span class="line"><span class="comment">  编写：MISaD </span></span><br><span class="line"><span class="comment">  博客：http://blog.csdn.net/misadd  </span></span><br><span class="line"><span class="comment">  日期：2014.10.25 </span></span><br><span class="line"><span class="comment">  修改：2014.10.25 </span></span><br><span class="line"><span class="comment">        主要错误在于1.错误估计了逆序数的大小，先使用了long </span></span><br><span class="line"><span class="comment">                    2.merge中错误计算了逆序数个数  </span></span><br><span class="line"><span class="comment">  内容：1.读入文件流 </span></span><br><span class="line"><span class="comment">        2.子程序1,sorted-and-count，将数组递归分为两部分从而分别计算每一部分的逆序数 。  </span></span><br><span class="line"><span class="comment">        3.子程序2,merge-and-count,使用归并排序计算两部分组合的逆序数。  </span></span><br><span class="line"><span class="comment">------------------------------------------------*/</span>  </span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;  </span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fstream&gt;// 读入文件流  </span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;//创建vector数组  </span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">CountInversion</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">long</span> <span class="keyword">long</span>&gt;&amp;vec)</span></span>;  </span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">merge</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">long</span> <span class="keyword">long</span>&gt;&amp; vec,<span class="built_in">vector</span>&lt;<span class="keyword">long</span> <span class="keyword">long</span>&gt;&amp; v1,<span class="built_in">vector</span>&lt;<span class="keyword">long</span> <span class="keyword">long</span>&gt;&amp; v2)</span></span>;  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span>  </span></span><br><span class="line"><span class="function"></span>&#123;  </span><br><span class="line">    <span class="function">ifstream <span class="title">fin</span><span class="params">(<span class="string">"IntegerArray.txt"</span>)</span></span>;  </span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">long</span> <span class="keyword">long</span>&gt; init;  </span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> temp;  </span><br><span class="line">      </span><br><span class="line">    <span class="keyword">while</span>(fin&gt;&gt;temp)&#123;  </span><br><span class="line">        init.push_back(temp);   </span><br><span class="line">    &#125;  </span><br><span class="line">      </span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span>  dataSize = init.size() ;  </span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;<span class="string">"Data Size:"</span>&lt;&lt;dataSize&lt;&lt;<span class="built_in">endl</span>;  </span><br><span class="line">      </span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> x = CountInversion(init);  </span><br><span class="line">      </span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;x&lt;&lt;<span class="built_in">endl</span>;  </span><br><span class="line">      </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;  </span><br><span class="line">      </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">CountInversion</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">long</span> <span class="keyword">long</span>&gt;&amp;vec)</span>  </span></span><br><span class="line"><span class="function"></span>&#123;  </span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> n = vec.size();  </span><br><span class="line">    <span class="keyword">if</span>( <span class="number">1</span> == n )   </span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;  </span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> result = <span class="number">0</span>;  </span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> mid = n/<span class="number">2</span>;  </span><br><span class="line">      </span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">long</span> <span class="keyword">long</span>&gt; v1,v2;  </span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> k = <span class="number">0</span>;  </span><br><span class="line">    <span class="keyword">while</span>(k &lt; n)&#123;  </span><br><span class="line">        <span class="keyword">if</span>(k &lt; mid)&#123;  </span><br><span class="line">            v1.push_back(vec[k]);  </span><br><span class="line">            k++;  </span><br><span class="line">        &#125;  </span><br><span class="line">        <span class="keyword">else</span>&#123;  </span><br><span class="line">            v2.push_back(vec[k]);  </span><br><span class="line">            k++;   </span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">      </span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> leftNum,rightNum,splitNum;  </span><br><span class="line">    leftNum = CountInversion(v1);  </span><br><span class="line">    rightNum = CountInversion(v2);  </span><br><span class="line">    splitNum = merge(vec,v1,v2);  </span><br><span class="line">      </span><br><span class="line">    result = leftNum+rightNum+splitNum;  </span><br><span class="line">      </span><br><span class="line">    <span class="keyword">return</span> result;  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span>  <span class="title">merge</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">long</span> <span class="keyword">long</span>&gt;&amp; vec,<span class="built_in">vector</span>&lt;<span class="keyword">long</span> <span class="keyword">long</span>&gt;&amp; v1,<span class="built_in">vector</span>&lt;<span class="keyword">long</span> <span class="keyword">long</span>&gt;&amp; v2)</span>  </span></span><br><span class="line"><span class="function"></span>&#123;  </span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> n1 = v1.size();  </span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> n2 = v2.size();  </span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> n = n1 + n2;  </span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> num = <span class="number">0</span>;<span class="comment">//split-inversion number  </span></span><br><span class="line">      </span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> p1 = <span class="number">0</span>,p2 = <span class="number">0</span>;  </span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> k = <span class="number">0</span>;  </span><br><span class="line">    <span class="keyword">while</span>(k &lt; n &amp;&amp; p1 &lt; n1 &amp;&amp; p2 &lt; n2)  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="keyword">if</span>(v1[p1] &gt; v2[p2])&#123;  </span><br><span class="line">            vec[k] = v2[p2];  </span><br><span class="line">            num +=n1-p1;  </span><br><span class="line">            p2++;  </span><br><span class="line">        &#125;  </span><br><span class="line">        <span class="keyword">else</span>&#123;  </span><br><span class="line">            vec[k] =v1[p1];  </span><br><span class="line">            p1++;  </span><br><span class="line">        &#125;  </span><br><span class="line">        k++;  </span><br><span class="line">    &#125;  </span><br><span class="line">      </span><br><span class="line">    <span class="keyword">while</span>(p1 &lt; n1)&#123;  </span><br><span class="line">        vec[k] = v1[p1];  </span><br><span class="line">        p1++;  </span><br><span class="line">        k++;  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">while</span>(p2 &lt; n2)&#123;  </span><br><span class="line">        vec[k] = v2[p2];  </span><br><span class="line">        p2++;  </span><br><span class="line">        k++;  </span><br><span class="line">    &#125;  </span><br><span class="line">      </span><br><span class="line">    <span class="keyword">return</span> num;  </span><br><span class="line">      </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>首先讲一下基本的原理<br>首先用递归不断的将数组分成v1(0，mid-1)和v2(mid,n)两部分，具体计算逆序数则是通过归并排序来实现的，那么归并排序怎么实现计算逆序数的功能呢？<br>我们不妨假设v1,v2是两个分别已经按从小到达排好序的数组，所以如果v1[p1]&gt;v2[p2],那么v1中所有从p1开始到mid-1的数都可以与v2[p2]这一个元素是逆序组，所以通过归并排序可以省时省力的计算每一部分中的逆序数，最后只要将各部分的逆序数相加，就可以得到最终结果。</p><p>具体写程序的时候有一些问题，首先是读入文件流的时候有下面几种方法<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span>(fin&gt;&gt;temp)  </span><br><span class="line">&#123;  </span><br><span class="line">    init.push_back(temp);  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> p = <span class="number">0</span>; p &lt; <span class="number">100000</span>; p++) &#123;  </span><br><span class="line">    fin&gt;&gt;temp;  </span><br><span class="line">    init.push_back(temp);  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>但是不能这样<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span>(!fin.eof()) &#123;  </span><br><span class="line">       fin&gt;&gt;temp;  </span><br><span class="line">       init.push_back(temp);   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>因为fin读到文件末尾的时候，再次进行读写才会发现已经到了文件的末尾无法读取了，因此才会返回true；<br>比如说读到了最后一个数据了，此时仍然为false；当再次读入时候发现不能再读了,这时候才会返回true结束循环，然而这时已经将最后一个数据写入了两次。</p><p>然后应用vector数组的优势是比较灵活，push_back（x）的作用是将x依次放入数组；<br>size()作用是表示数组的大小；</p><p>两个子函数的作用在思路中已经做了简单的描述再次不想多说，然后我还想说一下数据大小；<br>因为我做的是1-100000中所有的数的任意排序的逆序数，所以是一个超出了2^31次，所以用long是不行的，所以改成了long long；当然也可以用double,但是直接输出的话会输出科学计数法，所以需要用<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cout</span>.setf(ios_base::fixed,ios_base::floatfield);</span><br></pre></td></tr></table></figure></p><p>当然还看到有大神是这么用的<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> str[<span class="number">20</span>];  </span><br><span class="line"><span class="built_in">sprintf</span>(str,<span class="string">"%.8lf"</span>,x);<span class="comment">//将格式化后的x存到字符串str中 （将浮点型转换成字符串）   </span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%s"</span>,str);<span class="comment">//不转换会按科学计数法输出</span></span><br></pre></td></tr></table></figure></p><p>简言之就是讲一个double的数字符串化之后输出。</p>]]></content>
      
      <categories>
          
          <category> 算法 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 分治 </tag>
            
            <tag> 技术 </tag>
            
            <tag> 算法 </tag>
            
        </tags>
      
    </entry>
    
  
  
</search>
